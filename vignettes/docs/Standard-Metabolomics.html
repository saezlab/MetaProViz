<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Standard-Metabolomics.knit</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">MetaProViz</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="MetaProViz.html">
    <span class="fa fa-home"></span>
     
    Introduction
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book-open"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Standard-Metabolomics.html">Standard Metabolomics</a>
    </li>
    <li>
      <a href="CoRe-Metabolomics.html">CoRe Metabolomics</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/rstudio4edu">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/rstudio">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>




</div>


<p><br />
<a href="#" class="btn btn-link"><a
href="https://github.com/ChristinaSchmidt1"><strong>Browse source
code</strong></a></a> <a href="#" class="btn btn-link"><a
href="https://github.com/ChristinaSchmidt1"><strong>View on
Bioconductor</strong></a></a> <a href="#" class="btn btn-link"><a
href="https://github.com/ChristinaSchmidt1"><strong>Citing
MetaProViz</strong></a></a> <a href="#" class="btn btn-link"><a
href="https://twitter.com/FrezzaLab"><strong>FrezzaLab</strong></a></a>
<a href="#" class="btn btn-link"><a
href="https://twitter.com/saezlab"><strong>SaezLab</strong></a></a></p>
<div class="progress progress-striped active">
<div class="progress-bar progress-bar-success" style="width: 100%">

</div>
</div>
<div id="standard-metabolomics" class="section level1">
<h1>Standard metabolomics</h1>
<div class="progress progress-striped active">
<div class="progress-bar progress-bar-success" style="width: 100%">

</div>
</div>
<p>A standard metabolomics experiment refers to intracellular extracts
(e.g. cell or bacteria culture), to tissue samples (e.g. from animals or
patients), to plasma samples (e.g. blood) and many other types of
experimental setups.<br />
<br />
<span style="text-decoration:underline">In this tutorial we showcase how
to use <strong>MetaProViz</strong></span>:<br />
<code>1.</code> To process raw peak data and identify outliers.<br />
<code>2.</code> To perform differential metabolite analysis (DMA) to
generate Log2FC and statistics.<br />
<code>3.</code> To do metabolite clustering analysis (MCA) to find
clusters of metabolites with similar behaviours.<br />
<code>4.</code> To use specific visualisations to aid biological
interpretation of the results.<br />
<br />
<br />
First if you have not done yet, install the required dependencies and
load the libraries:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MetaProViz</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(MetaProViz)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#dependencies</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<br />
<br />

<div class="progress progress-striped active">
<div class="progress-bar progress-bar-success" style="width: 100%">

</div>
</div>
</div>
<div id="loading-the-example-data" class="section level1">
<h1>1. Loading the example data</h1>
<div class="progress progress-striped active">
<div class="progress-bar progress-bar-success" style="width: 100%">

</div>
</div>
<p>Here we choose an example datasets, which is publicly available on <a
href="https://www.metabolomicsworkbench.org/data/DRCCMetadata.php?Mode=Project&amp;ProjectID=PR001418">metabolomics
workbench project PR001418</a> including metabolic profiles of human
renal epithelial cells HK2 and cell renal cell carcinoma (ccRCC) cell
lines cultured in Plasmax cell culture media. Here we use the integrated
raw peak data as example data using the trival metabolite name in
combination with the KEGG ID as the metabolite identifiers.<br />
<br />
<span style="text-decoration:underline">As part of the
<strong>MetaProViz</strong> package you can load the example data into
your global environment using the function
<code>toy_data()</code></span>:<br />
<br />
<code>1.</code> Intracellular experiment <strong>(Intra)</strong><br />
The raw data are available via <a
href="https://www.metabolomicsworkbench.org/data/DRCCMetadata.php?Mode=Study&amp;StudyID=ST002224&amp;StudyType=MS&amp;ResultType=1">metabolomics
workbench study ST002224</a> were intracellular metabolomics of HK2 and
ccRCC cell lines 786-O, 786-M1A and 786-M2A were performed.<br />
</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check load data again from inst/extdata</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(<span class="st">&quot;C:/Users/chris/Documents/GitHub/MetaProViz&quot;</span>)<span class="co">#only loaded until package is online</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ℹ Loading MetaProViz</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>MetaProViz<span class="sc">::</span><span class="fu">toy_data</span>(<span class="at">data=</span><span class="st">&quot;Standard&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#test &lt;- load(MS51_RawPeakData.csv)#I need to save it as .RDS file to load it from there</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#saveRDS(globalenv(), &quot;C:/Users/chris/Documents/GitHub/MetaProViz/inst/extdataStandard.rds&quot;)</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Check how our data looks like:</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(Intra[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="at">caption =</span> <span class="st">&quot;Preview of the DF `Intra` including columns with sample information and metabolite ids with their measured values.&quot;</span>)</span></code></pre></div>
<table>
<caption>Preview of the DF <code>Intra</code> including columns with
sample information and metabolite ids with their measured
values.</caption>
<colgroup>
<col width="7%" />
<col width="9%" />
<col width="19%" />
<col width="19%" />
<col width="9%" />
<col width="15%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Code</th>
<th align="left">Conditions</th>
<th align="right">Analytical_Replicates</th>
<th align="right">Biological_Replicates</th>
<th align="right">valine-d8</th>
<th align="right">hippuric acid-d5</th>
<th align="right">2/3-phosphoglycerate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MS55_01</td>
<td align="left">HK2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1910140239</td>
<td align="right">4155279397</td>
<td align="right">39391514</td>
</tr>
<tr class="even">
<td align="left">MS55_02</td>
<td align="left">HK2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2030901280</td>
<td align="right">4238215810</td>
<td align="right">42341710</td>
</tr>
<tr class="odd">
<td align="left">MS55_03</td>
<td align="left">HK2</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">2001950756</td>
<td align="right">4197553754</td>
<td align="right">44519478</td>
</tr>
<tr class="even">
<td align="left">MS55_04</td>
<td align="left">HK2</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">1971520079</td>
<td align="right">4322171919</td>
<td align="right">38994961</td>
</tr>
<tr class="odd">
<td align="left">MS55_05</td>
<td align="left">786-O</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2150817213</td>
<td align="right">4297449325</td>
<td align="right">41381177</td>
</tr>
</tbody>
</table>
<p><br />
<code>2.</code> Pathway information mapping the trivial metabolite names
to KEGG IDs and pathways <strong>(Pathways)</strong><br />
</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>MetaProViz<span class="sc">::</span><span class="fu">toy_data</span>(<span class="at">data=</span><span class="st">&quot;Pathways&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check how our data looks like:</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(Pathways[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,], <span class="at">caption =</span> <span class="st">&quot;Preview of the DF `Pathways` including the trivial metabolite identifiers used in the experiment as well as KEGG IDs and pathway information.&quot;</span>)</span></code></pre></div>
<table>
<caption>Preview of the DF <code>Pathways</code> including the trivial
metabolite identifiers used in the experiment as well as KEGG IDs and
pathway information.</caption>
<colgroup>
<col width="25%" />
<col width="7%" />
<col width="25%" />
<col width="42%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Metabolite</th>
<th align="left">KEGG.ID</th>
<th align="left">KEGGCompound</th>
<th align="left">Pathway</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N-acetylaspartate</td>
<td align="left">C01042</td>
<td align="left">N-Acetyl-L-aspartate</td>
<td align="left">Alanine, aspartate and glutamate metabolism</td>
</tr>
<tr class="even">
<td align="left">argininosuccinate</td>
<td align="left">C03406</td>
<td align="left">N-(L-Arginino)succinate</td>
<td align="left">Alanine, aspartate and glutamate metabolism</td>
</tr>
<tr class="odd">
<td align="left">N-acetylaspartylglutamate</td>
<td align="left">C12270</td>
<td align="left">N-Acetylaspartylglutamate</td>
<td align="left">Alanine, aspartate and glutamate metabolism</td>
</tr>
<tr class="even">
<td align="left">creatinine</td>
<td align="left">C00791</td>
<td align="left">Creatinine</td>
<td align="left">Arginine and proline metabolism</td>
</tr>
<tr class="odd">
<td align="left">4-guanidinobutanoate</td>
<td align="left">C01035</td>
<td align="left">4-Guanidinobutanoate</td>
<td align="left">Arginine and proline metabolism</td>
</tr>
</tbody>
</table>
<p><br />
We will split the experimental data into the sample information and the
metabolites values using the the column “Code” as the unique
identifier:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Intra_M <span class="ot">&lt;-</span> Intra[<span class="dv">1</span><span class="sc">:</span><span class="dv">47</span>,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)]<span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">&quot;Code&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>SampleInfo <span class="ot">&lt;-</span>Intra[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">47</span>),<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)]<span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">&quot;Code&quot;</span>)</span></code></pre></div>
<br />
<br />

<div class="progress progress-striped active">
<div class="progress-bar progress-bar-success" style="width: 550%">

</div>
</div>
</div>
<div id="run-metaproviz-functions" class="section level1">
<h1>2. Run MetaProViz functions</h1>
<div class="progress progress-striped active">
<div class="progress-bar progress-bar-success" style="width: 550%">

</div>
</div>
<p>Currently, <strong>MetaProViz</strong> contains four different
modules, which include different methods and can be used independently
from each other or in combination (see introduction for more details).
Here we will go trough each of those modules and apply them to example
data.</p>
<div id="pre-processing" class="section level2">
<h2>2.1. Pre-processing</h2>
<p><strong>MetaProViz</strong> includes a pre-processing module with the
function <code>Preprocessing()</code> that has multiple parameters to
perform customize data processing.<br />
<code>Feature_Filtering</code> applies the 80%-filtering rule on the
metabolite features either on the whole dataset (=“Standard”) (Bijlsma
S. et al., 2006) or per condition (=“Modified”) (Yang, J et al., 2015).
This means that metabolites are removed were more than 20% of the
samples (all or per condition) have no detection. With the parameter
<code>Feature_Filt_Value</code> we enable the adaptation of the
stringency of the filtering based on the experimental context. For
instance, patient tumour samples can contain many unknown subgroups due
to gender, age, stage etc., which leads to a metabolite being detected
in only 50% (or even less) of the tumour samples, hence in this context
it could be considered to change the <code>Feature_Filt_Value</code>
from the default (=0.8). If <code>Feature_Filtering = "None"</code>, no
feature filtering is performed. In the context of
<code>Feature_Filtering</code> it is also noteworthy that the function
<code>Pool_Estimation</code> can be used to estimate the quality of the
metabolite detection and will return a list of metabolites that are
variable across the different pool (mixture of all experimental samples
measured several times during the LC-MS run) measurements and hence the
quality of the detection is poor and hence the metabolite should be
removed from the data.<br />
The paramteter <code>TIC_Normalization</code> refers to Total Ion Count
(TIC) normalisation, which is often used with LC-MS derived metabolomics
data. If <code>TIC_Normalization = TRUE</code>, each feature
(=metabolite) in a sample is divided by the sum of all intensity value
(= total number of ions) for the sample and finally multiplied by a
constant ( = the mean of all samples total number of ions). Noteworthy,
TIC normalisation should not be used with small number of features (=
metabolites), since TIC assumes that on “average” the ion count of each
sample is equal if there were no instrument batch effects (Wulff et.
al., (2018)).<br />
The parameter <code>MVI</code> refers to Missing Value Imputation (MVI)
and if <code>MVI = TRUE</code> half minimum (HM) missing value
imputation is performed per feature (= per metabolite). Here it is
important to mention that HM has been shown to perform well for missing
vales that are missing not at random (MNAR) (Wei et. al., 2018 ,<a
href="https://www.nature.com/articles/s41598-017-19120-0"
class="uri">https://www.nature.com/articles/s41598-017-19120-0</a>).<br />
Lastly, the function <code>Preprocessing()</code> performs outlier
detection and add a column “Outliers” into the DF, which can be used to
remove outliers. The parameter <code>HotellinsConfidence</code> can be
used to choose the confidence intervall that should be used for the
Hotellins T2 outlier test (Hotelling, H., 1931, <a
href="doi:https://doi.org/10.1214/aoms/1177732979"
class="uri">doi:https://doi.org/10.1214/aoms/1177732979</a>.).<br />
Notes on MVI: - Wei quantile regression imputation of left-censored data
(QRILC) as performing best even though HM performs better in some of
their tests and quantile normalisation would not work well for normal
distribution! - Show MVI results with different percentages (not just
50% as per half minimum!) –&gt; implement parameter for user to change?
- Show that per feature imputation is advantageous over the “standard”
imputation –&gt; change standard to per feature!<br />
Now we will apply the <code>Preprocessing()</code> function to example
data and have a look at the output produced. You will notice that all
the chosen parameters and results are documented in messages:<br />
</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Do the pool control first!</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>PPres <span class="ot">&lt;-</span> MetaProViz<span class="sc">::</span><span class="fu">Preprocessing</span>(<span class="at">Input_data=</span>Intra_M,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Experimental_design=</span>SampleInfo,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Feature_Filtering =</span> <span class="st">&quot;Modified&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Feature_Filt_Value =</span> <span class="fl">0.8</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">TIC_Normalization =</span> <span class="cn">TRUE</span>,<span class="co"># As we have raw data we will perform total ion count normalisation</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">MVI=</span><span class="cn">TRUE</span>, <span class="co">#We assume the values are not mising at random and perform half minimum missing value imputation</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">HotellinsConfidence =</span> <span class="fl">0.99</span>,<span class="co"># We perform outlier testing using 0.99 confidence intervall</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ExportQCPlots =</span> <span class="cn">TRUE</span>,<span class="co"># we will save the quality control plots</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">CoRe =</span> <span class="cn">FALSE</span>,<span class="co"># as we have a standard experiment and not a Consumption-Release (CoRe) experiment we set this to FALSE</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Save_as =</span> <span class="st">&quot;svg&quot;</span>) <span class="co">#we will save the QC plots as .svg files</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Here we apply the modified 80%-filtering rule that takes the class information (Column `Conditions`) into account, which additionally reduces the effect of missing values. REF: Yang et. al., (2015), doi: 10.3389/fmolb.2015.00004)</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; filtering value selected: 0.8</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ***Performing modified feature filtering***</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 metabolites where removed: AICAR, FAICAR, SAICAR</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Missing value imputation is performed, as a complementary approach to address the missing value problem, where the missing values are imputing using the `half minimum value`. REF: Wei et. al., (2018), Reports, 8, 663, doi:https://doi.org/10.1038/s41598-017-19120-0</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Total Ion Count (TIC) normalization is used to reduce the variation from non-biological sources, while maintaining the biological variation. REF: Wulff et. al., (2018), Advances in Bioscience and Biotechnology, 9, 339-351, doi:https://doi.org/10.4236/abb.2018.98022</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Identification of outlier samples is performed using Hotellin&#39;s T2 test to define sample outliers in a mathematical way (Confidence = 0.99 ~ p.val &lt; 0.01) REF: Hotelling, H. (1931), Annals of Mathematical Statistics. 2 (3), 360–378, doi:https://doi.org/10.1214/aoms/1177732979.</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HotellinsConfidence value selected: 0.99</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ***Checking for outliers***</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ***Checking for outliers***</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; There are possible outlier samples in the data</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Filtering round 1 Outlier Samples: MS55_29</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Done</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>Intra_Preprocessed <span class="ot">&lt;-</span> PPres[[<span class="st">&quot;Processed_data&quot;</span>]]</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Check how our data looks like:</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(Intra_Preprocessed[<span class="dv">29</span><span class="sc">:</span><span class="dv">32</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]<span class="sc">%&gt;%</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;Code&quot;</span>), <span class="at">caption =</span> <span class="st">&quot;Preview of the pre-processing results, which has an additional column `Outlier` including the results of Hotellins T2.&quot;</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<caption>Preview of the pre-processing results, which has an additional
column <code>Outlier</code> including the results of Hotellins
T2.</caption>
<colgroup>
<col width="5%" />
<col width="7%" />
<col width="15%" />
<col width="15%" />
<col width="18%" />
<col width="7%" />
<col width="12%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Code</th>
<th align="left">Conditions</th>
<th align="right">Analytical_Replicates</th>
<th align="right">Biological_Replicates</th>
<th align="left">Outliers</th>
<th align="right">valine-d8</th>
<th align="right">hippuric acid-d5</th>
<th align="right">2/3-phosphoglycerate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">MS55_29</td>
<td align="left">786-M2A</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">Outlier_filtering_round_1</td>
<td align="right">2389973416</td>
<td align="right">4573651797</td>
<td align="right">40224280</td>
</tr>
<tr class="even">
<td align="left">MS55_30</td>
<td align="left">786-M2A</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="left">no</td>
<td align="right">2131636596</td>
<td align="right">3913339135</td>
<td align="right">40942211</td>
</tr>
<tr class="odd">
<td align="left">MS55_31</td>
<td align="left">786-M2A</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="left">no</td>
<td align="right">2010263314</td>
<td align="right">3823948533</td>
<td align="right">45701915</td>
</tr>
<tr class="even">
<td align="left">MS55_32</td>
<td align="left">786-M2A</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="left">no</td>
<td align="right">2025373868</td>
<td align="right">3812717059</td>
<td align="right">46212138</td>
</tr>
</tbody>
</table>
<br />
In the output table you can now see the column “Outliers” and for the
Condition 786-M2A, we can see that based on Hotellin’s T2 test, one
sample was detected as an oulier in the first round of filtering.<br />
As part of the <code>Preprocessing()</code> function several results are
saved including quality control plots are saved, which we can further
check for the outlier:<br />
<br />

<center>
<img
src="MetaProViz_Results_2023-06-26/Preprocessing/Quality_Control_PCA/PCA_Condition_Clustering.svg"
style="width:100.0%" /><br />
<br />
<img
src="MetaProViz_Results_2023-06-26/Preprocessing/Outlier_detection/Hotelling_OD_round_1.svg"
style="width:100.0%" />
</center>
<p><br />
Now we will remove the outlier before proceeding:<br />
</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Intra_Preprocessed <span class="ot">&lt;-</span> Intra_Preprocessed[<span class="sc">-</span><span class="dv">29</span>,]<span class="co">#remove MS55_29</span></span></code></pre></div>
<p><br />
As you may have noticed, in this example dataset we have several
biological replicates that where injected (=measured) several times,
which can be termed as analytical replicates. The
<strong>MetaProViz</strong> pre-processing module includes the function
<code>ReplicateSum</code>, which will do this task and save the
results:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Intra_Preprocessed <span class="ot">&lt;-</span> MetaProViz<span class="sc">::</span><span class="fu">ReplicateSum</span>(<span class="at">Input_data=</span>Intra_Preprocessed)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Done</span></span></code></pre></div>
</div>
<div id="dma" class="section level2">
<h2>2.2. DMA</h2>
<p>Differential Metabolite Analysis (<code>DMA</code>) between two
conditions (e.g. Tumour versus Healthy) calculates the Log2FC, p-value,
adjusted p-value and t-value. With the different parameters of the
<code>DMA</code> function one can choose the statistical tests to
calculate the p-value and adjusted p-value (<code>STAT_pval</code> and
<code>STAT_padj</code>).</p>
<p>Notes DMA: The input can either be the output of the
<code>Preprocessing</code> module or any DF including metabolite values
and information about the conditions that should be compared. explain
the way we deal with 0/NA –&gt; again refer back to above! Similar to
DESEq2 explain what it means if a Log2FC = Inf &amp; p.val=NA versus
Log2FC= Value &amp; p.val=NA<br />
In the example data we have four different cell lines, healthy (HK2) and
cancer (ccRCC: 786-M1A, 786-M2A and 786-O) and hence we can perform
mutliple different comparisons:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>DMA_HK2v786O <span class="ot">&lt;-</span> MetaProViz<span class="sc">::</span><span class="fu">DMA</span>(<span class="at">Input_data=</span>Intra_Preprocessed[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)], <span class="co">#we need to remove columns that do not include metabolite measurements</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Experimental_design=</span>Intra_Preprocessed[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)],<span class="co">#we only maintain the information columns we need here</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">Condition1=</span><span class="st">&quot;HK2&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">Condition2=</span><span class="st">&quot;786-O&quot;</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">STAT_pval =</span><span class="st">&quot;t.test&quot;</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">STAT_padj=</span><span class="st">&quot;fdr&quot;</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">Input_Pathways =</span> Pathways[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)], </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">OutputName=</span><span class="st">&#39;DMA_HK2v786O&#39;</span>, </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">CoRe=</span><span class="cn">FALSE</span>, </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">Plot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">Save_as =</span> <span class="st">&quot;svg&quot;</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; There are no NA/0 values</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 79.89 % of the metabolites follow a normal distribution and 20.11 % of the metabolites are not-normally distributed according to the shapiro test. `shapiro.test` ignores missing values in the calculation.</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Check how our data looks like:</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(DMA_HK2v786O[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,], <span class="at">caption =</span> <span class="st">&quot;Preview of the DMA results for the comparison of HK2 versus 786-O cells.&quot;</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<caption>Preview of the DMA results for the comparison of HK2 versus
786-O cells.</caption>
<colgroup>
<col width="23%" />
<col width="11%" />
<col width="10%" />
<col width="10%" />
<col width="11%" />
<col width="32%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Metabolite</th>
<th align="right">Log2FC</th>
<th align="right">p.val</th>
<th align="right">p.adj</th>
<th align="right">t.val</th>
<th align="left">Pathway</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2-aminoadipic acid</td>
<td align="right">-0.4171492</td>
<td align="right">0.0417030</td>
<td align="right">0.0794131</td>
<td align="right">-2.0364722</td>
<td align="left">Not assigned</td>
</tr>
<tr class="even">
<td align="left">2-hydroxyglutarate</td>
<td align="right">-0.9161858</td>
<td align="right">0.0026323</td>
<td align="right">0.0142571</td>
<td align="right">-3.0077003</td>
<td align="left">Not assigned</td>
</tr>
<tr class="odd">
<td align="left">2-ketoglutarate</td>
<td align="right">-1.3589969</td>
<td align="right">0.0009498</td>
<td align="right">0.0080963</td>
<td align="right">-3.3049760</td>
<td align="left">Citrate cycle (TCA cycle)</td>
</tr>
<tr class="even">
<td align="left">2/3-phosphoglycerate</td>
<td align="right">-0.0566840</td>
<td align="right">0.6623858</td>
<td align="right">0.7504245</td>
<td align="right">-0.4366215</td>
<td align="left">Glycolysis / Gluconeogenesis</td>
</tr>
<tr class="odd">
<td align="left">4-guanidinobutanoate</td>
<td align="right">1.0099082</td>
<td align="right">0.0048373</td>
<td align="right">0.0166516</td>
<td align="right">2.8176711</td>
<td align="left">Arginine and proline metabolism</td>
</tr>
<tr class="even">
<td align="left">4-hydroxyphenyllactate</td>
<td align="right">0.9472270</td>
<td align="right">0.0001368</td>
<td align="right">0.0034989</td>
<td align="right">3.8138313</td>
<td align="left">Not assigned</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Perform the other comparisons;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>DMA_HK2v786M1A <span class="ot">&lt;-</span> MetaProViz<span class="sc">::</span><span class="fu">DMA</span>(<span class="at">Input_data=</span>Intra_Preprocessed[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)], <span class="co">#we need to remove columns that do not include metabolite measurements</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">Experimental_design=</span>Intra_Preprocessed[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)],<span class="co">#we only maintain the information columns we need here</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">Condition1=</span><span class="st">&quot;HK2&quot;</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">Condition2=</span><span class="st">&quot;786-M1A&quot;</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">STAT_pval =</span><span class="st">&quot;t.test&quot;</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">STAT_padj=</span><span class="st">&quot;fdr&quot;</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">Input_Pathways =</span> Pathways[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)], </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">OutputName=</span><span class="st">&#39;DMA_HK2v786M1A&#39;</span>, </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">CoRe=</span><span class="cn">FALSE</span>, </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">Plot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">Save_as =</span> <span class="st">&quot;svg&quot;</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; There are no NA/0 values</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 79.89 % of the metabolites follow a normal distribution and 20.11 % of the metabolites are not-normally distributed according to the shapiro test. `shapiro.test` ignores missing values in the calculation.</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>DMA_HK2v786M2A <span class="ot">&lt;-</span> MetaProViz<span class="sc">::</span><span class="fu">DMA</span>(<span class="at">Input_data=</span>Intra_Preprocessed[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)], <span class="co">#we need to remove columns that do not include metabolite measurements</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">Experimental_design=</span>Intra_Preprocessed[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)],<span class="co">#we only maintain the information columns we need here</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">Condition1=</span><span class="st">&quot;HK2&quot;</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">Condition2=</span><span class="st">&quot;786-M2A&quot;</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">STAT_pval =</span><span class="st">&quot;t.test&quot;</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">STAT_padj=</span><span class="st">&quot;fdr&quot;</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">Input_Pathways =</span> Pathways[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)], </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">OutputName=</span><span class="st">&#39;DMA_HK2v786M2A&#39;</span>, </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">CoRe=</span><span class="cn">FALSE</span>, </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">Plot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">Save_as =</span> <span class="st">&quot;svg&quot;</span>)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; There are no NA/0 values</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 85.47 % of the metabolites follow a normal distribution and 14.53 % of the metabolites are not-normally distributed according to the shapiro test. `shapiro.test` ignores missing values in the calculation.</span></span></code></pre></div>
<p>Why are the plots not shown? –&gt; mention/show that the volcano plot
is saved when Plot=TRUE</p>
</div>
<div id="mca" class="section level2">
<h2>2.3. MCA</h2>
<p>Metabolite Clustering Analysis (<code>MCA</code>)is a module</p>
<p>Create Figure (alluvial plot) explaining the general concept –&gt;
usable for manuscript as well</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Example of all possible flows:</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>MetaProViz<span class="sc">::</span><span class="fu">MCA_rules</span>(<span class="at">data=</span><span class="st">&quot;2Cond&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check how our data looks like:</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(MCA_2Cond, <span class="at">caption =</span> <span class="st">&quot;Metabolite Clustering Analysis: 2 Conditions.&quot;</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<caption>Metabolite Clustering Analysis: 2 Conditions.</caption>
<colgroup>
<col width="15%" />
<col width="15%" />
<col width="41%" />
<col width="11%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Cond1</th>
<th align="left">Cond2</th>
<th align="left">RG1_All</th>
<th align="left">RG2_Significant</th>
<th align="left">RG3_SignificantChange</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">DOWN</td>
<td align="left">DOWN</td>
<td align="left">Cond1 DOWN + Cond2 DOWN</td>
<td align="left">Core_DOWN</td>
<td align="left">Core_DOWN</td>
</tr>
<tr class="even">
<td align="left">DOWN</td>
<td align="left">Not Detected</td>
<td align="left">Cond1 DOWN + Cond2 Not Detected</td>
<td align="left">Cond1_DOWN</td>
<td align="left">Cond1_DOWN</td>
</tr>
<tr class="odd">
<td align="left">DOWN</td>
<td align="left">Not Significant</td>
<td align="left">Cond1 DOWN + Cond2 Not Significant</td>
<td align="left">Cond1_DOWN</td>
<td align="left">Cond1_DOWN</td>
</tr>
<tr class="even">
<td align="left">DOWN</td>
<td align="left">Significant Negative</td>
<td align="left">Cond1 DOWN + Cond2 Significant Negative</td>
<td align="left">Core_DOWN</td>
<td align="left">Cond1_DOWN</td>
</tr>
<tr class="odd">
<td align="left">DOWN</td>
<td align="left">Significant Positive</td>
<td align="left">Cond1 DOWN + Cond2 Significant Positive</td>
<td align="left">Opposite</td>
<td align="left">Cond1_DOWN</td>
</tr>
<tr class="even">
<td align="left">DOWN</td>
<td align="left">UP</td>
<td align="left">Cond1 DOWN + Cond2 UP</td>
<td align="left">Opposite</td>
<td align="left">Opposite</td>
</tr>
<tr class="odd">
<td align="left">UP</td>
<td align="left">DOWN</td>
<td align="left">Cond1 UP + Cond2 DOWN</td>
<td align="left">Opposite</td>
<td align="left">Opposite</td>
</tr>
<tr class="even">
<td align="left">UP</td>
<td align="left">Not Detected</td>
<td align="left">Cond1 UP + Cond2 Not Detected</td>
<td align="left">Cond1_UP</td>
<td align="left">Cond1_UP</td>
</tr>
<tr class="odd">
<td align="left">UP</td>
<td align="left">Not Significant</td>
<td align="left">Cond1 UP + Cond2 Not Significant</td>
<td align="left">Cond1_UP</td>
<td align="left">Cond1_UP</td>
</tr>
<tr class="even">
<td align="left">UP</td>
<td align="left">Significant Negative</td>
<td align="left">Cond1 UP + Cond2 Significant Negative</td>
<td align="left">Opposite</td>
<td align="left">Cond1_UP</td>
</tr>
<tr class="odd">
<td align="left">UP</td>
<td align="left">Significant Positive</td>
<td align="left">Cond1 UP + Cond2 Significant Positive</td>
<td align="left">Core_UP</td>
<td align="left">Cond1_UP</td>
</tr>
<tr class="even">
<td align="left">UP</td>
<td align="left">UP</td>
<td align="left">Cond1 UP + Cond2 UP</td>
<td align="left">Core_UP</td>
<td align="left">Core_UP</td>
</tr>
<tr class="odd">
<td align="left">Not Detected</td>
<td align="left">DOWN</td>
<td align="left">Cond1 Not Detected + Cond2 DOWN</td>
<td align="left">Cond2_DOWN</td>
<td align="left">Cond2_DOWN</td>
</tr>
<tr class="even">
<td align="left">Not Detected</td>
<td align="left">Not Detected</td>
<td align="left">Cond1 Not Detected + Cond2 Not Detected</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="odd">
<td align="left">Not Detected</td>
<td align="left">Not Significant</td>
<td align="left">Cond1 Not Detected + Cond2 Not Significant</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="even">
<td align="left">Not Detected</td>
<td align="left">Significant Negative</td>
<td align="left">Cond1 Not Detected + Cond2 Significant Negative</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="odd">
<td align="left">Not Detected</td>
<td align="left">Significant Positive</td>
<td align="left">Cond1 Not Detected + Cond2 Significant Positive</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="even">
<td align="left">Not Detected</td>
<td align="left">UP</td>
<td align="left">Cond1 Not Detected + Cond2 UP</td>
<td align="left">Cond2_UP</td>
<td align="left">Cond2_UP</td>
</tr>
<tr class="odd">
<td align="left">Significant Negative</td>
<td align="left">DOWN</td>
<td align="left">Cond1 Significant Negative + Cond2 DOWN</td>
<td align="left">Core_DOWN</td>
<td align="left">Cond2_DOWN</td>
</tr>
<tr class="even">
<td align="left">Significant Negative</td>
<td align="left">Not Detected</td>
<td align="left">Cond1 Significant Negative + Cond2 Not Detected</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="odd">
<td align="left">Significant Negative</td>
<td align="left">Not Significant</td>
<td align="left">Cond1 Significant Negative + Cond2 Not Significant</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="even">
<td align="left">Significant Negative</td>
<td align="left">Significant Negative</td>
<td align="left">Cond1 Significant Negative + Cond2 Significant
Negative</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="odd">
<td align="left">Significant Negative</td>
<td align="left">Significant Positive</td>
<td align="left">Cond1 Significant Negative + Cond2 Significant
Positive</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="even">
<td align="left">Significant Negative</td>
<td align="left">UP</td>
<td align="left">Cond1 Significant Negative + Cond2 UP</td>
<td align="left">Opposite</td>
<td align="left">Cond2_UP</td>
</tr>
<tr class="odd">
<td align="left">Significant Positive</td>
<td align="left">DOWN</td>
<td align="left">Cond1 Significant Positive + Cond2 DOWN</td>
<td align="left">Opposite</td>
<td align="left">Cond2_DOWN</td>
</tr>
<tr class="even">
<td align="left">Significant Positive</td>
<td align="left">Not Detected</td>
<td align="left">Cond1 Significant Positive + Cond2 Not Detected</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="odd">
<td align="left">Significant Positive</td>
<td align="left">Not Significant</td>
<td align="left">Cond1 Significant Positive + Cond2 Not Significant</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="even">
<td align="left">Significant Positive</td>
<td align="left">Significant Negative</td>
<td align="left">Cond1 Significant Positive + Cond2 Significant
Negative</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="odd">
<td align="left">Significant Positive</td>
<td align="left">Significant Positive</td>
<td align="left">Cond1 Significant Positive + Cond2 Significant
Positive</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="even">
<td align="left">Significant Positive</td>
<td align="left">UP</td>
<td align="left">Cond1 Significant Positive + Cond2 UP</td>
<td align="left">Core_UP</td>
<td align="left">Cond2_UP</td>
</tr>
<tr class="odd">
<td align="left">Not Significant</td>
<td align="left">DOWN</td>
<td align="left">Cond1 Not Significant + Cond2 DOWN</td>
<td align="left">Cond2_DOWN</td>
<td align="left">Cond2_DOWN</td>
</tr>
<tr class="even">
<td align="left">Not Significant</td>
<td align="left">Not Detected</td>
<td align="left">Cond1 Not Significant + Cond2 Not Detected</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="odd">
<td align="left">Not Significant</td>
<td align="left">Not Significant</td>
<td align="left">Cond1 Not Significant + Cond2 Not Significant</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="even">
<td align="left">Not Significant</td>
<td align="left">Significant Negative</td>
<td align="left">Cond1 Not Significant + Cond2 Significant Negative</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="odd">
<td align="left">Not Significant</td>
<td align="left">Significant Positive</td>
<td align="left">Cond1 Not Significant + Cond2 Significant Positive</td>
<td align="left">None</td>
<td align="left">None</td>
</tr>
<tr class="even">
<td align="left">Not Significant</td>
<td align="left">UP</td>
<td align="left">Cond1 Not Significant + Cond2 UP</td>
<td align="left">Cond1_UP</td>
<td align="left">Cond1_UP</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#easyalluvial --&gt; update allulvial plot package used to this one!</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>easyalluvial<span class="sc">::</span><span class="fu">alluvial_wide</span>(MCA_2Cond[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">4</span>)], <span class="at">fill_by =</span> <span class="st">&#39;last_variable&#39;</span> )</span></code></pre></div>
<p><img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>easyalluvial<span class="sc">::</span><span class="fu">alluvial_wide</span>(MCA_2Cond[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">5</span>)], <span class="at">fill_by =</span> <span class="st">&#39;last_variable&#39;</span> )</span></code></pre></div>
<p><img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<p>Now let’s use the data and do clustering: mention sircle concept that
was adapted here! –&gt; add the citation to function?</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>MCAres <span class="ot">&lt;-</span> MetaProViz<span class="sc">::</span><span class="fu">MCA_2Cond</span>(<span class="at">Cond1_File=</span>DMA_HK2v786O,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Cond2_File=</span>DMA_HK2v786M1A,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">MetaboliteID=</span> <span class="st">&quot;Metabolite&quot;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Cond1ValueCol=</span><span class="st">&quot;Log2FC&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Cond1PadjCol=</span><span class="st">&quot;p.adj&quot;</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Cond2ValueCol=</span><span class="st">&quot;Log2FC&quot;</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Cond2PadjCol=</span><span class="st">&quot;p.adj&quot;</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Cond1_padj_cutoff=</span> <span class="fl">0.05</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Cond2_padj_cutoff =</span> <span class="fl">0.05</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Cond1_FC_cutoff=</span> <span class="dv">1</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Cond2_FC_cutoff =</span> <span class="dv">1</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">backgroundMethod=</span><span class="st">&quot;C1&amp;C2&quot;</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">OutputFileName =</span> <span class="st">&quot;MCA_2Cond&quot;</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Check how our data looks like:</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(Summary_MCA_2Cond , <span class="at">caption =</span> <span class="st">&quot;Summary of MCA: 2 Conditions.&quot;</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<caption>Summary of MCA: 2 Conditions.</caption>
<colgroup>
<col width="23%" />
<col width="59%" />
<col width="17%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Regulation Grouping</th>
<th align="left">SiRCle cluster Name</th>
<th align="right">Number of Genes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">RG1_All</td>
<td align="left">Cond1 DOWN + Cond2 DOWN</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">RG1_All</td>
<td align="left">Cond1 DOWN + Cond2 Significant Negative</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">RG1_All</td>
<td align="left">Cond1 Not Significant + Cond2 DOWN</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">RG1_All</td>
<td align="left">Cond1 Not Significant + Cond2 Not Significant</td>
<td align="right">87</td>
</tr>
<tr class="odd">
<td align="left">RG1_All</td>
<td align="left">Cond1 Not Significant + Cond2 Significant Negative</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">RG1_All</td>
<td align="left">Cond1 Not Significant + Cond2 Significant Positive</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">RG1_All</td>
<td align="left">Cond1 Significant Negative + Cond2 DOWN</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">RG1_All</td>
<td align="left">Cond1 Significant Negative + Cond2 Not Significant</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">RG1_All</td>
<td align="left">Cond1 Significant Negative + Cond2 Significant
Negative</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">RG1_All</td>
<td align="left">Cond1 Significant Positive + Cond2 Not Significant</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">RG1_All</td>
<td align="left">Cond1 Significant Positive + Cond2 Significant
Positive</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="left">RG1_All</td>
<td align="left">Cond1 Significant Positive + Cond2 UP</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">RG1_All</td>
<td align="left">Cond1 UP + Cond2 Not Significant</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">RG1_All</td>
<td align="left">Cond1 UP + Cond2 Significant Positive</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">RG1_All</td>
<td align="left">Cond1 UP + Cond2 UP</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="left">RG2_Significant</td>
<td align="left">Cond1_UP</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">RG2_Significant</td>
<td align="left">Cond2_DOWN</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">RG2_Significant</td>
<td align="left">Core_DOWN</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="left">RG2_Significant</td>
<td align="left">Core_UP</td>
<td align="right">30</td>
</tr>
<tr class="even">
<td align="left">RG2_Significant</td>
<td align="left">None</td>
<td align="right">131</td>
</tr>
<tr class="odd">
<td align="left">RG3_SignificantChange</td>
<td align="left">Cond1_DOWN</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">RG3_SignificantChange</td>
<td align="left">Cond1_UP</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">RG3_SignificantChange</td>
<td align="left">Cond2_DOWN</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">RG3_SignificantChange</td>
<td align="left">Cond2_UP</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">RG3_SignificantChange</td>
<td align="left">Core_DOWN</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">RG3_SignificantChange</td>
<td align="left">Core_UP</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="left">RG3_SignificantChange</td>
<td align="left">None</td>
<td align="right">131</td>
</tr>
</tbody>
</table>
<p>Next lets try kmeans clustering:</p>
</div>
<div id="visualisation-viz" class="section level2">
<h2>2.4. Visualisation (Viz)</h2>
<p>In general, each of the different plot types (e.g. Volcano plot,
Lollipop graph,…) have 3 main <code>Plot_Settings</code>.<br />
<code>1.</code> <code>"Standard"</code> is the standard version of the
plot, with one dataset being plotted. <code>2.</code>
<code>"Conditions"</code> here two or more datasets will be plotted
together. How datasets can be plotted together depends on the plot
type.<br />
<code>3.</code> <code>"GSE"</code> stands for Gene Set Enrichment, and
is used if the results of an GSE analysis should be plotted as here the
figure legends will be adapted.<br />
<br />
In each of those Plot_Settings, the user can label color and/or shape
based on additional information (e.g. Pathway information, Cluster
information or other other demographics like gender). Moreover, we also
enable to plot individual plots based on those additional information
(e.g. one plot for each metabolic pathway).</p>
<div id="volcano-plot" class="section level3">
<h3>Volcano plot</h3>
<p>Here we will look at all the different options we have to display our
results from the different analysis (DMA, MCA, GSE), which will help us
to interpret our results as this can be sometimes difficult from the
many data tables.</p>
<div id="standard" class="section level4">
<h4>Standard</h4>
<p>Here we will first look into the results from the differential
analysis (see above 2.2 DMA) for the comparison of
<code>HK2 versus 786M1A</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run with default parameter --&gt; only need to provide Input_data and the title we like</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>MetaProViz<span class="sc">::</span><span class="fu">VizVolcano</span>(<span class="at">Input_data=</span>DMA_HK2v786M1A,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">OutputPlotName=</span> <span class="st">&quot;HK2 versus 786M1A&quot;</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Subtitle=</span> <span class="st">&quot;Results of DMA&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-12-1.png" alt="Figure: Standard figure displaying DMA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results.
</p>
</div>
<p><br />
Next we may be interested to understand which metabolite clusters based
on our MCA the metabolites of the plot correspond to. In order to do
this we can provide a Plot_SettingsFile with this additional information
and use this information to color code and/or to shape the dots on the
volcano plot. In order to choose the right column we need to provide a
vector Plot_SettingsInfo with this information.<br />
</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Settings <span class="ot">&lt;-</span> MCAres[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>)]<span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;Metabolite&quot;</span><span class="ot">=</span><span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check our settings:</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(Settings[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,] , <span class="at">caption =</span> <span class="st">&quot;Settings for plots.&quot;</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<caption>Settings for plots.</caption>
<thead>
<tr class="header">
<th align="left">Metabolite</th>
<th align="left">RG3_SignificantChange</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2-aminoadipic acid</td>
<td align="left">None</td>
</tr>
<tr class="even">
<td align="left">2-hydroxyglutarate</td>
<td align="left">None</td>
</tr>
<tr class="odd">
<td align="left">2-ketoglutarate</td>
<td align="left">Core_DOWN</td>
</tr>
<tr class="even">
<td align="left">2/3-phosphoglycerate</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we need to add our Plot_SettingsFile and the Plot_SettingsInfo:</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>MetaProViz<span class="sc">::</span><span class="fu">VizVolcano</span>(<span class="at">Plot_Settings=</span><span class="st">&quot;Standard&quot;</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Plot_SettingsInfo=</span> <span class="fu">c</span>(<span class="at">color=</span><span class="st">&quot;RG3_SignificantChange&quot;</span>),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Plot_SettingsFile=</span> Settings,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Input_data=</span>DMA_HK2v786M1A,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">OutputPlotName=</span> <span class="st">&quot;HK2 versus 786M1A&quot;</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Subtitle=</span> <span class="st">&quot;Results of DMA colour coded for metabolic clusters&quot;</span> )</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-13-1.png" alt="Figure: Standard figure displaying DMA results colour coded/shaped for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results colour coded/shaped for
metabolic clusters from MCA results.
</p>
</div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#If we want to use the shape instead of the colour for the cluster info, we can just change our Plot_SettingsInfo</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>MetaProViz<span class="sc">::</span><span class="fu">VizVolcano</span>(<span class="at">Plot_Settings=</span><span class="st">&quot;Standard&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Plot_SettingsInfo=</span> <span class="fu">c</span>(<span class="at">shape=</span><span class="st">&quot;RG3_SignificantChange&quot;</span>),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Plot_SettingsFile=</span> Settings,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Input_data=</span>DMA_HK2v786M1A,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">OutputPlotName=</span> <span class="st">&quot;HK2 versus 786M1A&quot;</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Subtitle=</span> <span class="st">&quot;Results of DMA shape for metabolic clusters&quot;</span> )</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-13-2.png" alt="Figure: Standard figure displaying DMA results colour coded/shaped for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results colour coded/shaped for
metabolic clusters from MCA results.
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Of course, we can also adapt both, color and shape for the same parameter:</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>MetaProViz<span class="sc">::</span><span class="fu">VizVolcano</span>(<span class="at">Plot_Settings=</span><span class="st">&quot;Standard&quot;</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Plot_SettingsInfo=</span> <span class="fu">c</span>(<span class="at">shape=</span><span class="st">&quot;RG3_SignificantChange&quot;</span>, <span class="at">color=</span><span class="st">&quot;RG3_SignificantChange&quot;</span>),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Plot_SettingsFile=</span> Settings,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Input_data=</span>DMA_HK2v786M1A,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">OutputPlotName=</span> <span class="st">&quot;HK2 versus 786M1A&quot;</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Subtitle=</span> <span class="st">&quot;Results of DMA shape for metabolic clusters&quot;</span> )</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-13-3.png" alt="Figure: Standard figure displaying DMA results colour coded/shaped for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results colour coded/shaped for
metabolic clusters from MCA results.
</p>
</div>
<p><br />
Given that we also know, which metabolic pathway the metabolites
correspond to, we can add this information into the plot too.<br />
</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Settings <span class="ot">&lt;-</span> <span class="fu">merge</span>(Settings, Pathways, <span class="at">by=</span><span class="st">&quot;Metabolite&quot;</span>, <span class="at">all.x=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check our settings:</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(Settings[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,] , <span class="at">caption =</span> <span class="st">&quot;Settings for plots.&quot;</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<caption>Settings for plots.</caption>
<colgroup>
<col width="20%" />
<col width="21%" />
<col width="7%" />
<col width="21%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Metabolite</th>
<th align="left">RG3_SignificantChange</th>
<th align="left">KEGG.ID</th>
<th align="left">KEGGCompound</th>
<th align="left">Pathway</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2-aminoadipic acid</td>
<td align="left">None</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">Not assigned</td>
</tr>
<tr class="even">
<td align="left">2-hydroxyglutarate</td>
<td align="left">None</td>
<td align="left">C02630</td>
<td align="left">2-Hydroxyglutarate</td>
<td align="left">Not assigned</td>
</tr>
<tr class="odd">
<td align="left">2-ketoglutarate</td>
<td align="left">Core_DOWN</td>
<td align="left">C00026</td>
<td align="left">2-Oxoglutarate</td>
<td align="left">Citrate cycle (TCA cycle)</td>
</tr>
<tr class="even">
<td align="left">2/3-phosphoglycerate</td>
<td align="left">None</td>
<td align="left">C00197</td>
<td align="left">3-Phospho-D-glycerate</td>
<td align="left">Glycolysis / Gluconeogenesis</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we can use color for the pathways and shape for the metabolite clusters:</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>MetaProViz<span class="sc">::</span><span class="fu">VizVolcano</span>(<span class="at">Plot_Settings=</span><span class="st">&quot;Standard&quot;</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Plot_SettingsInfo=</span> <span class="fu">c</span>(<span class="at">shape=</span><span class="st">&quot;RG3_SignificantChange&quot;</span>, <span class="at">color=</span><span class="st">&quot;Pathway&quot;</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Plot_SettingsFile=</span> Settings,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Input_data=</span>DMA_HK2v786M1A,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">OutputPlotName=</span> <span class="st">&quot;HK2 versus 786M1A&quot;</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Subtitle=</span> <span class="st">&quot;Results of DMA shape for metabolic clusters&quot;</span> )</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-14-1.png" alt="Figure: Standard figure displaying DMA results colour coded for metabolic pathways and shaped for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results colour coded for
metabolic pathways and shaped for metabolic clusters from MCA results.
</p>
</div>
<p><br />
We immediately see that there are many pathways displayed on the plot,
which can make it difficult to interpret. Hence, we will change our plot
settings in order to get individual plots for each of the
pathways:<br />
</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Now we can generate a plot for each pathway and color for the metabolite clusters:</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>MetaProViz<span class="sc">::</span><span class="fu">VizVolcano</span>(<span class="at">Plot_Settings=</span><span class="st">&quot;Standard&quot;</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Plot_SettingsInfo=</span> <span class="fu">c</span>(<span class="at">color=</span><span class="st">&quot;RG3_SignificantChange&quot;</span>, <span class="at">individual=</span><span class="st">&quot;Pathway&quot;</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Plot_SettingsFile=</span> Settings,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Input_data=</span>DMA_HK2v786M1A,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">OutputPlotName=</span> <span class="st">&quot;HK2 versus 786M1A&quot;</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Subtitle=</span> <span class="st">&quot;Results of DMA shape for metabolic clusters&quot;</span> )</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-1.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-2.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-3.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-4.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<pre><code>#&gt; Warning: Removed 1 rows containing missing values (`geom_vline()`).</code></pre>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-5.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<pre><code>#&gt; Warning: Removed 1 rows containing missing values (`geom_vline()`).</code></pre>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-6.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-7.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-8.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-9.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-10.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-11.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-12.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-13.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-14.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<pre><code>#&gt; Warning: Removed 1 rows containing missing values (`geom_vline()`).</code></pre>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-15.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
<pre><code>#&gt; Warning: Removed 1 rows containing missing values (`geom_vline()`).</code></pre>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-15-16.png" alt="Figure: Standard figure displaying DMA results for each pathway, colour coded for metabolic clusters from MCA results." width="768" />
<p class="caption">
Figure: Standard figure displaying DMA results for each pathway, colour
coded for metabolic clusters from MCA results.
</p>
</div>
</div>
<div id="comparison" class="section level4">
<h4>Comparison</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>MetaProViz<span class="sc">::</span><span class="fu">VizVolcano</span>(<span class="at">Plot_Settings=</span><span class="st">&quot;Compare&quot;</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#Plot_SettingsInfo= c(color=&quot;RG3_SignificantChange&quot;, individual=&quot;Pathway&quot;),</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                       <span class="co">#Plot_SettingsFile= Settings,</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Input_data=</span>DMA_HK2v786M1A,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">AdditionalInput_data=</span>DMA_HK2v786M2A,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">OutputPlotName=</span> <span class="st">&quot;HK2 vs. 786M1A compared to HK2 vs. 786M2A&quot;</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Subtitle=</span> <span class="st">&quot;Results of DMA&quot;</span> )</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-1.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>MetaProViz<span class="sc">::</span><span class="fu">VizVolcano</span>(<span class="at">Plot_Settings=</span><span class="st">&quot;Compare&quot;</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Plot_SettingsInfo=</span> <span class="fu">c</span>(<span class="at">individual=</span><span class="st">&quot;Pathway&quot;</span>),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Plot_SettingsFile=</span> Settings,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Input_data=</span>DMA_HK2v786M1A,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">AdditionalInput_data=</span>DMA_HK2v786M2A,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">OutputPlotName=</span> <span class="st">&quot;HK2 vs. 786M1A compared to HK2 vs. 786M2A&quot;</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Subtitle=</span> <span class="st">&quot;Results of DMA&quot;</span> )</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-2.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-3.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-4.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-5.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<pre><code>#&gt; Warning: Removed 1 rows containing missing values (`geom_vline()`).</code></pre>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-6.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<pre><code>#&gt; Warning: Removed 1 rows containing missing values (`geom_vline()`).</code></pre>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-7.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-8.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-9.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-10.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-11.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-12.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-13.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-14.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-15.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-16.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Standard-Metabolomics_files/figure-html/unnamed-chunk-16-17.png" alt="Figure: Comparison." width="576" />
<p class="caption">
Figure: Comparison.
</p>
</div>
</div>
<div id="gse" class="section level4">
<h4>GSE</h4>
<hr />
<p class="text-success">
*Now you have finished with the example run for standard metabolomics
data. #2
</p>
<br />
<br />
<br />

<div class="progress progress-striped active">
<div class="progress-bar progress-bar-success" style="width: 100%">

</div>
</div>
</div>
</div>
</div>
</div>
<div id="session-information" class="section level1">
<h1>Session information</h1>
<hr />
<pre><code>#&gt; ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────
#&gt;  setting  value
#&gt;  version  R version 4.2.2 (2022-10-31 ucrt)
#&gt;  os       Windows 10 x64 (build 19044)
#&gt;  system   x86_64, mingw32
#&gt;  ui       RTerm
#&gt;  language (EN)
#&gt;  collate  English_United Kingdom.utf8
#&gt;  ctype    English_United Kingdom.utf8
#&gt;  tz       Europe/Berlin
#&gt;  date     2023-07-03
#&gt;  pandoc   2.19.2 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)
#&gt; 
#&gt; ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────
#&gt;  ! package         * version    date (UTC) lib source
#&gt;    abind             1.4-5      2016-07-21 [1] CRAN (R 4.2.0)
#&gt;    backports         1.4.1      2021-12-13 [1] CRAN (R 4.2.0)
#&gt;    brio              1.1.3      2021-11-30 [1] CRAN (R 4.2.2)
#&gt;    broom             1.0.3      2023-01-25 [1] CRAN (R 4.2.2)
#&gt;    bslib             0.4.2      2022-12-16 [1] CRAN (R 4.2.2)
#&gt;    cachem            1.0.6      2021-08-19 [1] CRAN (R 4.2.2)
#&gt;    callr             3.7.3      2022-11-02 [1] CRAN (R 4.2.2)
#&gt;    car               3.1-1      2022-10-19 [1] CRAN (R 4.2.2)
#&gt;    carData           3.0-5      2022-01-06 [1] CRAN (R 4.2.2)
#&gt;    class             7.3-20     2022-01-16 [2] CRAN (R 4.2.2)
#&gt;    cli               3.6.0      2023-01-09 [1] CRAN (R 4.2.2)
#&gt;    codetools         0.2-18     2020-11-04 [2] CRAN (R 4.2.2)
#&gt;    colorspace        2.1-0      2023-01-23 [1] CRAN (R 4.2.2)
#&gt;    crayon            1.5.2      2022-09-29 [1] CRAN (R 4.2.2)
#&gt;    desc              1.4.2      2022-09-08 [1] CRAN (R 4.2.2)
#&gt;    devtools          2.4.5      2022-10-11 [1] CRAN (R 4.2.2)
#&gt;    digest            0.6.31     2022-12-11 [1] CRAN (R 4.2.2)
#&gt;    dplyr           * 1.1.0      2023-01-29 [1] CRAN (R 4.2.2)
#&gt;    easyalluvial      0.3.1      2022-07-05 [1] CRAN (R 4.2.2)
#&gt;    ellipsis          0.3.2      2021-04-29 [1] CRAN (R 4.2.2)
#&gt;    EnhancedVolcano   1.16.0     2022-11-01 [1] Bioconductor
#&gt;    evaluate          0.20       2023-01-17 [1] CRAN (R 4.2.2)
#&gt;    factoextra        1.0.7      2020-04-01 [1] CRAN (R 4.2.2)
#&gt;    fansi             1.0.4      2023-01-22 [1] CRAN (R 4.2.2)
#&gt;    farver            2.1.1      2022-07-06 [1] CRAN (R 4.2.2)
#&gt;    fastmap           1.1.0      2021-01-25 [1] CRAN (R 4.2.2)
#&gt;    forcats         * 1.0.0      2023-01-29 [1] CRAN (R 4.2.2)
#&gt;    fs                1.6.0      2023-01-23 [1] CRAN (R 4.2.2)
#&gt;    future            1.31.0     2023-02-01 [1] CRAN (R 4.2.2)
#&gt;    future.apply      1.10.0     2022-11-05 [1] CRAN (R 4.2.2)
#&gt;    generics          0.1.3      2022-07-05 [1] CRAN (R 4.2.2)
#&gt;    ggalluvial        0.12.4     2023-02-03 [1] CRAN (R 4.2.2)
#&gt;    ggplot2         * 3.4.2      2023-04-03 [1] CRAN (R 4.2.3)
#&gt;    ggpubr            0.5.0      2022-11-16 [1] CRAN (R 4.2.2)
#&gt;    ggrepel           0.9.3      2023-02-03 [1] CRAN (R 4.2.2)
#&gt;    ggridges          0.5.4      2022-09-26 [1] CRAN (R 4.2.2)
#&gt;    ggsignif          0.6.4      2022-10-13 [1] CRAN (R 4.2.2)
#&gt;    globals           0.16.2     2022-11-21 [1] CRAN (R 4.2.2)
#&gt;    glue              1.6.2      2022-02-24 [1] CRAN (R 4.2.2)
#&gt;    gower             1.0.1      2022-12-22 [1] CRAN (R 4.2.2)
#&gt;    gridExtra         2.3        2017-09-09 [1] CRAN (R 4.2.2)
#&gt;    gtable            0.3.1      2022-09-01 [1] CRAN (R 4.2.2)
#&gt;    gtools            3.9.4      2022-11-27 [1] CRAN (R 4.2.2)
#&gt;    hardhat           1.2.0      2022-06-30 [1] CRAN (R 4.2.2)
#&gt;    hash              2.2.6.2    2022-03-22 [1] CRAN (R 4.2.2)
#&gt;    highr             0.10       2022-12-22 [1] CRAN (R 4.2.2)
#&gt;    hms               1.1.2      2022-08-19 [1] CRAN (R 4.2.2)
#&gt;    htmltools         0.5.4      2022-12-07 [1] CRAN (R 4.2.2)
#&gt;    htmlwidgets       1.6.1      2023-01-07 [1] CRAN (R 4.2.2)
#&gt;    httpuv            1.6.8      2023-01-12 [1] CRAN (R 4.2.2)
#&gt;    inflection        1.3.6      2022-06-15 [1] CRAN (R 4.2.2)
#&gt;    ipred             0.9-13     2022-06-02 [1] CRAN (R 4.2.2)
#&gt;    jquerylib         0.1.4      2021-04-26 [1] CRAN (R 4.2.2)
#&gt;    jsonlite          1.8.4      2022-12-06 [1] CRAN (R 4.2.2)
#&gt;    knitr             1.42       2023-01-25 [1] CRAN (R 4.2.2)
#&gt;    labeling          0.4.2      2020-10-20 [1] CRAN (R 4.2.0)
#&gt;    later             1.3.0      2021-08-18 [1] CRAN (R 4.2.2)
#&gt;    lattice           0.20-45    2021-09-22 [2] CRAN (R 4.2.2)
#&gt;    lava              1.7.1      2023-01-06 [1] CRAN (R 4.2.2)
#&gt;    lifecycle         1.0.3      2022-10-07 [1] CRAN (R 4.2.2)
#&gt;    listenv           0.9.0      2022-12-16 [1] CRAN (R 4.2.2)
#&gt;    lubridate       * 1.9.1      2023-01-24 [1] CRAN (R 4.2.2)
#&gt;    magrittr          2.0.3      2022-03-30 [1] CRAN (R 4.2.2)
#&gt;    MASS              7.3-58.1   2022-08-03 [2] CRAN (R 4.2.2)
#&gt;    Matrix            1.5-1      2022-09-13 [2] CRAN (R 4.2.2)
#&gt;    memoise           2.0.1      2021-11-26 [1] CRAN (R 4.2.2)
#&gt;  P MetaProViz      * 0.0.0.9000 2023-02-16 [?] load_all()
#&gt;    mime              0.12       2021-09-28 [1] CRAN (R 4.2.0)
#&gt;    miniUI            0.1.1.1    2018-05-18 [1] CRAN (R 4.2.2)
#&gt;    munsell           0.5.0      2018-06-12 [1] CRAN (R 4.2.2)
#&gt;    nnet              7.3-18     2022-09-28 [2] CRAN (R 4.2.2)
#&gt;    parallelly        1.34.0     2023-01-13 [1] CRAN (R 4.2.2)
#&gt;    pillar            1.8.1      2022-08-19 [1] CRAN (R 4.2.2)
#&gt;    pkgbuild          1.4.0      2022-11-27 [1] CRAN (R 4.2.2)
#&gt;    pkgconfig         2.0.3      2019-09-22 [1] CRAN (R 4.2.2)
#&gt;    pkgload           1.3.2      2022-11-16 [1] CRAN (R 4.2.2)
#&gt;    prettyunits       1.1.1      2020-01-24 [1] CRAN (R 4.2.2)
#&gt;    processx          3.8.0      2022-10-26 [1] CRAN (R 4.2.2)
#&gt;    prodlim           2019.11.13 2019-11-17 [1] CRAN (R 4.2.2)
#&gt;    profvis           0.3.7      2020-11-02 [1] CRAN (R 4.2.2)
#&gt;    progressr         0.13.0     2023-01-10 [1] CRAN (R 4.2.2)
#&gt;    promises          1.2.0.1    2021-02-11 [1] CRAN (R 4.2.2)
#&gt;    ps                1.7.2      2022-10-26 [1] CRAN (R 4.2.2)
#&gt;    purrr           * 1.0.1      2023-01-10 [1] CRAN (R 4.2.2)
#&gt;    qcc               2.7        2017-07-11 [1] CRAN (R 4.2.2)
#&gt;    R6                2.5.1      2021-08-19 [1] CRAN (R 4.2.2)
#&gt;    ragg              1.2.5      2023-01-12 [1] CRAN (R 4.2.2)
#&gt;    RColorBrewer      1.1-3      2022-04-03 [1] CRAN (R 4.2.0)
#&gt;    Rcpp              1.0.10     2023-01-22 [1] CRAN (R 4.2.2)
#&gt;    readr           * 2.1.3      2022-10-01 [1] CRAN (R 4.2.2)
#&gt;    recipes           1.0.4      2023-01-11 [1] CRAN (R 4.2.2)
#&gt;    remotes           2.4.2      2021-11-30 [1] CRAN (R 4.2.2)
#&gt;    rlang             1.1.0      2023-03-14 [1] CRAN (R 4.2.3)
#&gt;    rmarkdown         2.20       2023-01-19 [1] CRAN (R 4.2.2)
#&gt;    rpart             4.1.19     2022-10-21 [2] CRAN (R 4.2.2)
#&gt;    rprojroot         2.0.3      2022-04-02 [1] CRAN (R 4.2.2)
#&gt;    rstatix           0.7.2      2023-02-01 [1] CRAN (R 4.2.2)
#&gt;    rstudioapi        0.14       2022-08-22 [1] CRAN (R 4.2.2)
#&gt;    sass              0.4.5      2023-01-24 [1] CRAN (R 4.2.2)
#&gt;    scales            1.2.1      2022-08-20 [1] CRAN (R 4.2.2)
#&gt;    sessioninfo       1.2.2      2021-12-06 [1] CRAN (R 4.2.2)
#&gt;    shiny             1.7.4      2022-12-15 [1] CRAN (R 4.2.2)
#&gt;    stringi           1.7.12     2023-01-11 [1] CRAN (R 4.2.2)
#&gt;    stringr         * 1.5.0      2022-12-02 [1] CRAN (R 4.2.2)
#&gt;    survival          3.4-0      2022-08-09 [2] CRAN (R 4.2.2)
#&gt;    svglite           2.1.1      2023-01-10 [1] CRAN (R 4.2.2)
#&gt;    systemfonts       1.0.4      2022-02-11 [1] CRAN (R 4.2.2)
#&gt;    testthat        * 3.1.6      2022-12-09 [1] CRAN (R 4.2.2)
#&gt;    textshaping       0.3.6      2021-10-13 [1] CRAN (R 4.2.2)
#&gt;    tibble          * 3.1.8      2022-07-22 [1] CRAN (R 4.2.2)
#&gt;    tidyr           * 1.3.0      2023-01-24 [1] CRAN (R 4.2.2)
#&gt;    tidyselect        1.2.0      2022-10-10 [1] CRAN (R 4.2.2)
#&gt;    tidyverse       * 2.0.0      2023-02-22 [1] CRAN (R 4.2.3)
#&gt;    timechange        0.2.0      2023-01-11 [1] CRAN (R 4.2.2)
#&gt;    timeDate          4022.108   2023-01-07 [1] CRAN (R 4.2.2)
#&gt;    tzdb              0.3.0      2022-03-28 [1] CRAN (R 4.2.2)
#&gt;    urlchecker        1.0.1      2021-11-30 [1] CRAN (R 4.2.2)
#&gt;    usethis           2.1.6      2022-05-25 [1] CRAN (R 4.2.2)
#&gt;    utf8              1.2.2      2021-07-24 [1] CRAN (R 4.2.2)
#&gt;    vctrs             0.5.2      2023-01-23 [1] CRAN (R 4.2.2)
#&gt;    withr             2.5.0      2022-03-03 [1] CRAN (R 4.2.2)
#&gt;    writexl           1.4.2      2023-01-06 [1] CRAN (R 4.2.2)
#&gt;    xfun              0.36       2022-12-21 [1] CRAN (R 4.2.2)
#&gt;    xtable            1.8-4      2019-04-21 [1] CRAN (R 4.2.2)
#&gt;    yaml              2.3.7      2023-01-23 [1] CRAN (R 4.2.2)
#&gt; 
#&gt;  [1] C:/Users/chris/AppData/Local/R/win-library/4.2
#&gt;  [2] C:/Program Files/R/R-4.2.2/library
#&gt; 
#&gt;  P ── Loaded and on-disk path mismatch.
#&gt; 
#&gt; ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sample Metadata Analysis • MetaProViz</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../deps/search-1.0.0/fuse.min.js"></script><script src="../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Sample Metadata Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">MetaProViz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.99.26</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book-open"></span></button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-">
<li><a class="dropdown-item" href="../../articles/quick-start.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../../articles/vignettes/pkgdown/standard-metabolomics.html">Standard Metabolomics</a></li>
    <li><a class="dropdown-item" href="../../articles/vignettes/pkgdown/core-metabolomics.html">CoRe Metabolomics</a></li>
    <li><a class="dropdown-item" href="../../articles/vignettes/pkgdown/prior-knowledge.html">Prior Knowledge</a></li>
    <li><a class="dropdown-item" href="../../articles/vignettes/pkgdown/sample-metadata.html">Sample Metadata Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../reference/index.html"><span class="fa fa-solid fa-rocket"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/saezlab/MetaProViz"><span class="fa fa-brands fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://saezlab.org/"><span class="fa fas fa-university"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://frezza.cecad-labs.uni-koeln.de/home"><span class="fa fas fa-university"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="sample-metadata_files/kePrint-0.0.1/kePrint.js"></script><link href="sample-metadata_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sample Metadata Analysis</h1>
                        <h4 data-toc-skip class="author">Christina
Schmidt</h4>
            <address class="author_afil">
      Heidelberg University<br><small class="dont-index">Source: <a href="https://github.com/saezlab/MetaProViz/blob/main/vignettes/pkgdown/sample-metadata.Rmd" class="external-link"><code>vignettes/pkgdown/sample-metadata.Rmd</code></a></small>
      <div class="d-none name"><code>sample-metadata.Rmd</code></div>
    </address>
</div>

    
    
<style>
.vscroll-plot {
    width: 850px;
    height: 500px;
    overflow-y: scroll;
    overflow-x: hidden;
}
</style>
<div class="section level2">
<h2 id="section">
<img src="Hexagon_MetaProViz.png" align="right" width="200"><a class="anchor" aria-label="anchor" href="#section"></a>
</h2>
<p><br>
Tissue metabolomics experiment is a standard metabolomics experiment
using tissue samples (e.g. from animals or patients).<br><br><span style="text-decoration:underline">In this tutorial we showcase how
to use <strong>MetaProViz</strong></span>:<br></p>
<ul>
<li>to perform differential metabolite analysis (dma) to generate Log2FC
and statistics and perform pathway analysis using Over Representation
Analysis (ORA) on the results.<br>
</li>
<li>to do metabolite clustering analysis (MCA) to find clusters of
metabolites with similar behaviors based on patients demographics like
age, gender and tumour stage.<br>
</li>
<li>Find the main metabolite drivers that separate patients based on
their demographics like age, gender and tumour stage.<br><br>
First if you have not done yet, install the required dependencies and
load the libraries:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Install Rtools if you haven’t done this yet, using the appropriate version (e.g.windows or macOS).</span></span>
<span><span class="co"># 2. Install the latest development version from GitHub using devtools</span></span>
<span><span class="co"># devtools::install_github("https://github.com/saezlab/MetaProViz")</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://saezlab.github.io/MetaProViz" class="external-link">MetaProViz</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># dependencies that need to be loaded:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rlang.r-lib.org" class="external-link">rlang</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Please install the Biocmanager Dependencies:</span></span>
<span><span class="co"># BiocManager::install("EnhancedVolcano")</span></span></code></pre></div>
<br><br><div class="progress progress-striped active">
<div class="progress-bar progress-bar-success" style="width: 100%">

</div>
</div>
</div>
<div class="section level2">
<h2 id="loading-the-example-data">1. Loading the example data<a class="anchor" aria-label="anchor" href="#loading-the-example-data"></a>
</h2>
<div class="progress progress-striped active">
<div class="progress-bar progress-bar-success" style="width: 100%">

</div>
</div>
<p><br>
Here we choose an example datasets, which is publicly available in the
<a href="https://www.cell.com/cancer-cell/comments/S1535-6108(15)00468-7#supplementaryMaterial" class="external-link">paper</a>
“An Integrated Metabolic Atlas of Clear Cell Renal Cell Carcinoma”,
which includes metabolomic profiling on 138 matched clear cell renal
cell carcinoma (ccRCC)/normal tissue pairs <span class="citation">(Hakimi et al. 2016)</span>. Metabolomics was done
using The company Metabolon, so this is untargeted metabolomics. Here we
use the median normalised data from the supplementary table 2 of the
paper. We have combined the metainformation about the patients with the
metabolite measurements and removed unidentified metabolites. Lastly, we
have added a column “Stage” where Stage1 and Stage2 patients are
summarised to “EARLY-STAGE” and Stage3 and Stage4 patients to
“LATE-STAGE”. Moreover, we have added a column “Age”, where patients
with “AGE AT SURGERY” &lt;42 are defined as “Young” and patients with
AGE AT SURGERY &gt;58 as “Old” and the remaining patients as
“Middle”.<br></p>
<p>#<span style="text-decoration:underline">As part of the
<strong>MetaProViz</strong> package you can load the example data into
your global environment using the function
<code>toy_data()</code></span>:<br><code>1.</code> Tissue experiment <strong>(Intra)</strong><br>
We can access the built-in dataset <code>tissue_norm</code>, which
includes columns with Sample information and columns with the median
normalised measured metabolite integrated peaks.<br></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the example data:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tissue_norm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Tissue_Norm</span> <span class="op">&lt;-</span> <span class="va">tissue_norm</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Code"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic" style="font-size: 12px; font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Preview of the DF <code>Tissue_Norm</code> including columns with sample
information and metabolite ids with their measured values.
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
TISSUE_TYPE
</th>
<th style="text-align:left;">
GENDER
</th>
<th style="text-align:right;">
AGE_AT_SURGERY
</th>
<th style="text-align:left;">
TYPE-STAGE
</th>
<th style="text-align:left;">
STAGE
</th>
<th style="text-align:left;">
AGE
</th>
<th style="text-align:right;">
1,2-propanediol
</th>
<th style="text-align:right;">
1,3-dihydroxyacetone
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
DIAG-16076
</td>
<td style="text-align:left;">
TUMOR
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
74.7778
</td>
<td style="text-align:left;">
TUMOR-STAGE I
</td>
<td style="text-align:left;">
EARLY-STAGE
</td>
<td style="text-align:left;">
Old
</td>
<td style="text-align:right;">
0.710920
</td>
<td style="text-align:right;">
0.809182
</td>
</tr>
<tr>
<td style="text-align:left;">
DIAG-16077
</td>
<td style="text-align:left;">
NORMAL
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
74.7778
</td>
<td style="text-align:left;">
NORMAL-STAGE I
</td>
<td style="text-align:left;">
EARLY-STAGE
</td>
<td style="text-align:left;">
Old
</td>
<td style="text-align:right;">
0.339390
</td>
<td style="text-align:right;">
0.718725
</td>
</tr>
<tr>
<td style="text-align:left;">
DIAG-16078
</td>
<td style="text-align:left;">
TUMOR
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
77.1778
</td>
<td style="text-align:left;">
TUMOR-STAGE I
</td>
<td style="text-align:left;">
EARLY-STAGE
</td>
<td style="text-align:left;">
Old
</td>
<td style="text-align:right;">
0.413386
</td>
<td style="text-align:right;">
0.276412
</td>
</tr>
<tr>
<td style="text-align:left;">
DIAG-16079
</td>
<td style="text-align:left;">
NORMAL
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
77.1778
</td>
<td style="text-align:left;">
NORMAL-STAGE I
</td>
<td style="text-align:left;">
EARLY-STAGE
</td>
<td style="text-align:left;">
Old
</td>
<td style="text-align:right;">
1.595697
</td>
<td style="text-align:right;">
4.332451
</td>
</tr>
<tr>
<td style="text-align:left;">
DIAG-16080
</td>
<td style="text-align:left;">
TUMOR
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:right;">
59.0889
</td>
<td style="text-align:left;">
TUMOR-STAGE I
</td>
<td style="text-align:left;">
EARLY-STAGE
</td>
<td style="text-align:left;">
Old
</td>
<td style="text-align:right;">
0.573787
</td>
<td style="text-align:right;">
0.646791
</td>
</tr>
</tbody>
</table>
<p><code>2.</code> Additional information mapping the trivial metabolite
names to KEGG IDs, HMDB IDs, etc. and selected pathways
<strong>(MappingInfo)</strong><br></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tissue_meta</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Tissue_MetaData</span> <span class="op">&lt;-</span> <span class="va">tissue_meta</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Metabolite"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic" style="font-size: 12px; font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Preview of the DF <code>Tissue_MetaData</code> including the trivial
metabolite identifiers used in the experiment as well as IDs and pathway
information.
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
SUPER_PATHWAY
</th>
<th style="text-align:left;">
SUB_PATHWAY
</th>
<th style="text-align:left;">
CAS
</th>
<th style="text-align:right;">
PUBCHEM
</th>
<th style="text-align:left;">
KEGG
</th>
<th style="text-align:left;">
Group_HMDB
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1,2-propanediol
</td>
<td style="text-align:left;">
Lipid
</td>
<td style="text-align:left;">
Ketone bodies
</td>
<td style="text-align:left;">
57-55-6;
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
C00583
</td>
<td style="text-align:left;">
HMDB01881
</td>
</tr>
<tr>
<td style="text-align:left;">
1,3-dihydroxyacetone
</td>
<td style="text-align:left;">
Carbohydrate
</td>
<td style="text-align:left;">
Glycolysis, gluconeogenesis, pyruvate metabolism
</td>
<td style="text-align:left;">
62147-49-3;
</td>
<td style="text-align:right;">
670
</td>
<td style="text-align:left;">
C00184
</td>
<td style="text-align:left;">
HMDB01882
</td>
</tr>
<tr>
<td style="text-align:left;">
1,5-anhydroglucitol (1,5-AG)
</td>
<td style="text-align:left;">
Carbohydrate
</td>
<td style="text-align:left;">
Glycolysis, gluconeogenesis, pyruvate metabolism
</td>
<td style="text-align:left;">
154-58-5;
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
C07326
</td>
<td style="text-align:left;">
HMDB02712
</td>
</tr>
<tr>
<td style="text-align:left;">
10-heptadecenoate (17:1n7)
</td>
<td style="text-align:left;">
Lipid
</td>
<td style="text-align:left;">
Long chain fatty acid
</td>
<td style="text-align:left;">
29743-97-3;
</td>
<td style="text-align:right;">
5312435
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
10-nonadecenoate (19:1n9)
</td>
<td style="text-align:left;">
Lipid
</td>
<td style="text-align:left;">
Long chain fatty acid
</td>
<td style="text-align:left;">
73033-09-7;
</td>
<td style="text-align:right;">
5312513
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<br><div class="progress progress-striped active">
<div class="progress-bar progress-bar-success" style="width: 550%">

</div>
</div>
</div>
<div class="section level2">
<h2 id="run-metaproviz-analysis">2. Run MetaProViz Analysis<a class="anchor" aria-label="anchor" href="#run-metaproviz-analysis"></a>
</h2>
<div class="progress progress-striped active">
<div class="progress-bar progress-bar-success" style="width: 550%">

</div>
</div>
<div class="section level3">
<h3 id="pre-processing">Pre-processing<a class="anchor" aria-label="anchor" href="#pre-processing"></a>
</h3>
<p>This has been done by the authors of the paper and we will use the
median normalized data. If you want to know how you can use the
<strong>MetaProViz</strong> pre-processing module, please check out the
vignette:<br>
- <a href="https://saezlab.github.io/MetaProViz/articles/Standard%20Metabolomics.html" class="external-link">Standard
metabolomics data</a><br>
- <a href="https://saezlab.github.io/MetaProViz/articles/core%20Metabolomics.html" class="external-link">Consumption-Release
(core) metabolomics data from cell culture media</a><br></p>
</div>
<div class="section level3">
<h3 id="metadata-analysis">Metadata analysis<a class="anchor" aria-label="anchor" href="#metadata-analysis"></a>
</h3>
<p>We can use the patient’s metadata to find the main metabolite drivers
that separate patients based on their demographics like age, gender,
etc.<br><br>
Here the metadata analysis is based on principal component analysis
(PCA), which is a dimensionality reduction method that reduces all the
measured features (=metabolites) of one sample into a few features in
the different principal components, whereby each principal component can
explain a certain percentage of the variance between the different
samples. Hence, this enables interpretation of sample clustering based
on the measured features (=metabolites).<br>
The <code><a href="../../reference/metadata_analysis.html">metadata_analysis()</a></code> function will perform PCA to
extract the different PCs followed by annova to find the main metabolite
drivers that separate patients based on their demographics.<br><br></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MetaRes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/metadata_analysis.html">metadata_analysis</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">Tissue_Norm</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span><span class="op">]</span>,</span>
<span>metadata_sample<span class="op">=</span> <span class="va">Tissue_Norm</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">12</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span><span class="op">]</span>,</span>
<span>scaling <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>percentage <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>cutoff_stat<span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>cutoff_variance <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; The column names of the 'metadata_sample' contain special character that where removed.</span></span></code></pre></div>
<img src="sample-metadata_files/figure-html/code-3-1.png" class="r-plt" width="700"><br>
Ultimately, this is leading to clusters of metabolites that are driving
the separation of the different demographics.<br><br>
We generated the general anova output DF:<br><table class="table  lightable-classic" style="font-size: 12px; font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Preview of the DF MetaRes[[<code>res_aov</code>]] including the main
metabolite drivers that separate patients based on their demographics.
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
PC
</th>
<th style="text-align:left;">
tukeyHSD_Contrast
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
anova_sumsq
</th>
<th style="text-align:right;">
anova_meansq
</th>
<th style="text-align:right;">
anova_statistic
</th>
<th style="text-align:right;">
anova_p.value
</th>
<th style="text-align:right;">
tukeyHSD_p.adjusted
</th>
<th style="text-align:right;">
Explained_Variance
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
PC1
</td>
<td style="text-align:left;">
TUMOR-NORMAL
</td>
<td style="text-align:left;">
TISSUE_TYPE
</td>
<td style="text-align:right;">
7375.2212254
</td>
<td style="text-align:right;">
7375.2212254
</td>
<td style="text-align:right;">
90.1352800
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
19.0079573
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
PC1
</td>
<td style="text-align:left;">
Black-Asian
</td>
<td style="text-align:left;">
RACE
</td>
<td style="text-align:right;">
156.7549451
</td>
<td style="text-align:right;">
52.2516484
</td>
<td style="text-align:right;">
0.4795311
</td>
<td style="text-align:right;">
0.6967838
</td>
<td style="text-align:right;">
0.9992824
</td>
<td style="text-align:right;">
19.0079573
</td>
</tr>
<tr>
<td style="text-align:left;">
1777
</td>
<td style="text-align:left;">
PC232
</td>
<td style="text-align:left;">
White-Asian
</td>
<td style="text-align:left;">
RACE
</td>
<td style="text-align:right;">
0.2726952
</td>
<td style="text-align:right;">
0.0908984
</td>
<td style="text-align:right;">
0.9544580
</td>
<td style="text-align:right;">
0.4147472
</td>
<td style="text-align:right;">
0.5495634
</td>
<td style="text-align:right;">
0.0166997
</td>
</tr>
<tr>
<td style="text-align:left;">
1778
</td>
<td style="text-align:left;">
PC232
</td>
<td style="text-align:left;">
LATE-STAGE-EARLY-STAGE
</td>
<td style="text-align:left;">
STAGE
</td>
<td style="text-align:right;">
0.0360319
</td>
<td style="text-align:right;">
0.0360319
</td>
<td style="text-align:right;">
0.3776760
</td>
<td style="text-align:right;">
0.5393596
</td>
<td style="text-align:right;">
0.5393596
</td>
<td style="text-align:right;">
0.0166997
</td>
</tr>
<tr>
<td style="text-align:left;">
3191
</td>
<td style="text-align:left;">
PC9
</td>
<td style="text-align:left;">
White-Other
</td>
<td style="text-align:left;">
RACE
</td>
<td style="text-align:right;">
20.2626222
</td>
<td style="text-align:right;">
6.7542074
</td>
<td style="text-align:right;">
0.7090398
</td>
<td style="text-align:right;">
0.5473277
</td>
<td style="text-align:right;">
0.8897908
</td>
<td style="text-align:right;">
1.6658973
</td>
</tr>
<tr>
<td style="text-align:left;">
3192
</td>
<td style="text-align:left;">
PC9
</td>
<td style="text-align:left;">
Young-Middle
</td>
<td style="text-align:left;">
AGE
</td>
<td style="text-align:right;">
49.2030973
</td>
<td style="text-align:right;">
24.6015486
</td>
<td style="text-align:right;">
2.6213834
</td>
<td style="text-align:right;">
0.0745317
</td>
<td style="text-align:right;">
0.9979475
</td>
<td style="text-align:right;">
1.6658973
</td>
</tr>
</tbody>
</table>
<br>
We generated the summarised results output DF, where each feature
(=metabolite) was assigned a main demographics parameter this feature is
separating:<br><table class="table  lightable-classic" style="font-size: 12px; font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Preview of the DF MetaRes[[<code>res_summary</code>]] including the
metabolite drivers in rows and list the patients demographics they can
separate.
</caption>
<thead><tr>
<th style="text-align:left;">
feature
</th>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
Sum(Explained_Variance)
</th>
<th style="text-align:left;">
MainDriver
</th>
<th style="text-align:left;">
MainDriver_Term
</th>
<th style="text-align:right;">
MainDriver_Sum(VarianceExplained)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
N2-methylguanosine
</td>
<td style="text-align:left;">
AGE, GENDER, RACE, STAGE, TISSUE_TYPE
</td>
<td style="text-align:left;">
3.7598809871366, 2.75344828467363, 1.43932034747081, 25.2803273612931,
33.9484968841434
</td>
<td style="text-align:left;">
FALSE, FALSE, FALSE, FALSE, TRUE
</td>
<td style="text-align:left;">
TISSUE_TYPE
</td>
<td style="text-align:right;">
33.9485
</td>
</tr>
<tr>
<td style="text-align:left;">
5-methyltetrahydrofolate (5MeTHF)
</td>
<td style="text-align:left;">
AGE, GENDER, RACE, STAGE, TISSUE_TYPE
</td>
<td style="text-align:left;">
0.351143408196559, 0.294688079880209, 0.252515004077172,
19.4058160726611, 32.5442969233501
</td>
<td style="text-align:left;">
FALSE, FALSE, FALSE, FALSE, TRUE
</td>
<td style="text-align:left;">
TISSUE_TYPE
</td>
<td style="text-align:right;">
32.5443
</td>
</tr>
<tr>
<td style="text-align:left;">
N-acetylalanine
</td>
<td style="text-align:left;">
AGE, GENDER, RACE, STAGE, TISSUE_TYPE
</td>
<td style="text-align:left;">
0.381811888038144, 1.82507161869685, 2.97460134435356, 19.0079573465895,
32.5442969233501
</td>
<td style="text-align:left;">
FALSE, FALSE, FALSE, FALSE, TRUE
</td>
<td style="text-align:left;">
TISSUE_TYPE
</td>
<td style="text-align:right;">
32.5443
</td>
</tr>
<tr>
<td style="text-align:left;">
N-acetyl-aspartyl-glutamate (NAAG)
</td>
<td style="text-align:left;">
AGE, GENDER, RACE, STAGE, TISSUE_TYPE
</td>
<td style="text-align:left;">
0.212976478603115, 2.75344828467363, 0.235952044704099,
20.3572056704699, 32.2825995362096
</td>
<td style="text-align:left;">
FALSE, FALSE, FALSE, FALSE, TRUE
</td>
<td style="text-align:left;">
TISSUE_TYPE
</td>
<td style="text-align:right;">
32.2826
</td>
</tr>
<tr>
<td style="text-align:left;">
1-heptadecanoylglycerophosphoethanolamine*
</td>
<td style="text-align:left;">
AGE, GENDER, RACE, STAGE, TISSUE_TYPE
</td>
<td style="text-align:left;">
4.33031140898824, 0.267851018697989, 0.437853800763463,
22.8424358182214, 30.8783995754163
</td>
<td style="text-align:left;">
FALSE, FALSE, FALSE, FALSE, TRUE
</td>
<td style="text-align:left;">
TISSUE_TYPE
</td>
<td style="text-align:right;">
30.8784
</td>
</tr>
<tr>
<td style="text-align:left;">
1-linoleoylglycerophosphoethanolamine*
</td>
<td style="text-align:left;">
AGE, STAGE, TISSUE_TYPE
</td>
<td style="text-align:left;">
4.20115004304429, 22.7555733683955, 30.8783995754163
</td>
<td style="text-align:left;">
FALSE, FALSE, TRUE
</td>
<td style="text-align:left;">
TISSUE_TYPE
</td>
<td style="text-align:right;">
30.8784
</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##1. Tissue_Type</span></span>
<span><span class="va">TissueTypeList</span> <span class="op">&lt;-</span> <span class="va">MetaRes</span><span class="op">[[</span><span class="st">"res_summary"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">MainDriver_Term</span> <span class="op">==</span> <span class="st">"TISSUE_TYPE"</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`MainDriver_Sum(VarianceExplained)`</span><span class="op">&gt;</span><span class="fl">30</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">feature</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select columns tissue_norm that are in TissueTypeList if they exist</span></span>
<span><span class="va">Input_Heatmap</span> <span class="op">&lt;-</span> <span class="va">Tissue_Norm</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Tissue_Norm</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">TissueTypeList</span><span class="op">]</span><span class="co">#c("N1-methylguanosine", "N-acetylalanine", "lysylmethionine")</span></span>
<span></span>
<span><span class="co"># Heatmap: Metabolites that separate the demographics, like here TISSUE_TYPE</span></span>
<span><span class="fu"><a href="../../reference/viz_heatmap.html">viz_heatmap</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Input_Heatmap</span>,</span>
<span>metadata_sample <span class="op">=</span> <span class="va">Tissue_Norm</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span><span class="op">]</span>,</span>
<span>metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>color_Sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"TISSUE_TYPE"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>scale <span class="op">=</span><span class="st">"column"</span>,</span>
<span>plot_name <span class="op">=</span> <span class="st">"MainDrivers"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-metadata_files/figure-html/viz-heatmap-1.png" class="r-plt" width="960" style="display: block; margin: auto auto auto 0;"></p>
</div>
<div class="section level3">
<h3 id="dma">DMA<a class="anchor" aria-label="anchor" href="#dma"></a>
</h3>
Here we use Differential Metabolite Analysis (<code>dma</code>) to
compare two conditions (e.g. Tumour versus Healthy) by calculating the
Log2FC, p-value, adjusted p-value and t-value.<br>
For more information please see the vignette:<br>
- <a href="https://saezlab.github.io/MetaProViz/articles/Standard%20Metabolomics.html" class="external-link">Standard
metabolomics data</a><br>
- <a href="https://saezlab.github.io/MetaProViz/articles/core%20Metabolomics.html" class="external-link">Consumption-Release
(core) metabolomics data from cell culture media</a><br><br>
We will perform multiple comparisons based on the different patient
demographics available: 1. Tumour versus Normal: All patients 2. Tumour
versus Normal: Subset of <code>Early Stage</code> patients 3. Tumour
versus Normal: Subset of <code>Late Stage</code> patients 4. Tumour
versus Normal: Subset of <code>Young</code> patients 5. Tumour versus
Normal: Subset of <code>Old</code> patients<br><div class="vscroll-plot">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare the different selections</span></span>
<span><span class="va">EarlyStage</span> <span class="op">&lt;-</span> <span class="va">Tissue_Norm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">STAGE</span><span class="op">==</span> <span class="st">"EARLY-STAGE"</span><span class="op">)</span></span>
<span><span class="va">LateStage</span> <span class="op">&lt;-</span> <span class="va">Tissue_Norm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">STAGE</span><span class="op">==</span><span class="st">"LATE-STAGE"</span><span class="op">)</span></span>
<span><span class="va">Old</span> <span class="op">&lt;-</span> <span class="va">Tissue_Norm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">AGE</span><span class="op">==</span><span class="st">"Old"</span><span class="op">)</span></span>
<span><span class="va">Young</span> <span class="op">&lt;-</span> <span class="va">Tissue_Norm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">AGE</span><span class="op">==</span><span class="st">"Young"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DFs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"TissueType"</span> <span class="op">=</span> <span class="va">Tissue_Norm</span>,</span>
<span>    <span class="st">"EarlyStage"</span> <span class="op">=</span> <span class="va">EarlyStage</span>,</span>
<span>    <span class="st">"LateStage"</span> <span class="op">=</span> <span class="va">LateStage</span>,</span>
<span>    <span class="st">"Old"</span> <span class="op">=</span> <span class="va">Old</span>,</span>
<span>    <span class="st">"Young"</span> <span class="op">=</span> <span class="va">Young</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run dma</span></span>
<span><span class="va">ResList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">item</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">DFs</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co">#Get the right DF:</span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">DFs</span><span class="op">[[</span><span class="va">item</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Running dma for"</span>, <span class="va">item</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="co">#Create folder for saving each comparison</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"/MetaProViz_Results/dma/"</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"/MetaProViz_Results/dma/"</span>, <span class="va">item</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co">#Perform dma</span></span>
<span>    <span class="va">TvN</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/dma.html">dma</a></span><span class="op">(</span>data <span class="op">=</span>  <span class="va">data</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    metadata_sample <span class="op">=</span>  <span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Conditions<span class="op">=</span><span class="st">"TISSUE_TYPE"</span>, Numerator<span class="op">=</span><span class="st">"TUMOR"</span> , Denominator <span class="op">=</span> <span class="st">"NORMAL"</span><span class="op">)</span>,</span>
<span>    shapiro<span class="op">=</span><span class="cn">FALSE</span>, <span class="co">#The data have been normalized by the company that provided the results and include metabolites with zero variance as they were all imputed with the same missing value.</span></span>
<span>    path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"/MetaProViz_Results/dma/"</span>, <span class="va">item</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co">#Add Results to list</span></span>
<span>    <span class="va">ResList</span><span class="op">[[</span><span class="va">item</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">TvN</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Running dma for TissueType</span></span>
<span><span class="co">#&gt; There are no NA/0 values</span></span></code></pre></div>
<p><img src="sample-metadata_files/figure-html/Run_not_Display-1.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"></p>
<pre><code><span><span class="co">#&gt; Running dma for EarlyStage</span></span>
<span><span class="co">#&gt; There are no NA/0 values</span></span></code></pre>
<p><img src="sample-metadata_files/figure-html/Run_not_Display-2.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"></p>
<pre><code><span><span class="co">#&gt; Running dma for LateStage</span></span>
<span><span class="co">#&gt; There are no NA/0 values</span></span></code></pre>
<p><img src="sample-metadata_files/figure-html/Run_not_Display-3.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"></p>
<pre><code><span><span class="co">#&gt; Running dma for Old</span></span>
<span><span class="co">#&gt; There are no NA/0 values</span></span></code></pre>
<p><img src="sample-metadata_files/figure-html/Run_not_Display-4.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"></p>
<pre><code><span><span class="co">#&gt; Running dma for Young</span></span>
<span><span class="co">#&gt; There are no NA/0 values</span></span></code></pre>
<p><img src="sample-metadata_files/figure-html/Run_not_Display-5.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"></p>
</div>
<p><br><br><br></p>
<p>We can see from the different Volcano plots have smaller p.adjusted
values and differences in Log2FC range.<br>
Here we can also use the <code>MetaproViz::viz_volcano()</code> function
to plot comparisons together on the same plot, such as Tumour versus
Normal of young and old patients:<br></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Early versus Late Stage</span></span>
<span><span class="fu"><a href="../../reference/viz_volcano.html">viz_volcano</a></span><span class="op">(</span>plot_types<span class="op">=</span><span class="st">"Compare"</span>,</span>
<span>data<span class="op">=</span><span class="va">ResList</span><span class="op">[[</span><span class="st">"EarlyStage"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Metabolite"</span><span class="op">)</span>,</span>
<span>data2<span class="op">=</span> <span class="va">ResList</span><span class="op">[[</span><span class="st">"LateStage"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Metabolite"</span><span class="op">)</span>,</span>
<span>name_comparison<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>data<span class="op">=</span><span class="st">"EarlyStage"</span>, data2<span class="op">=</span> <span class="st">"LateStage"</span><span class="op">)</span>,</span>
<span>plot_name<span class="op">=</span> <span class="st">"EarlyStage-TUMOR_vs_NORMAL compared to LateStage-TUMOR_vs_NORMAL"</span>,</span>
<span>subtitle<span class="op">=</span> <span class="st">"Results of dma"</span> <span class="op">)</span></span></code></pre></div>
<p><img src="sample-metadata_files/figure-html/viz-volcano-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Young versus Old</span></span>
<span><span class="fu"><a href="../../reference/viz_volcano.html">viz_volcano</a></span><span class="op">(</span>plot_types<span class="op">=</span><span class="st">"Compare"</span>,</span>
<span>data<span class="op">=</span><span class="va">ResList</span><span class="op">[[</span><span class="st">"Young"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Metabolite"</span><span class="op">)</span>,</span>
<span>data2<span class="op">=</span> <span class="va">ResList</span><span class="op">[[</span><span class="st">"Old"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Metabolite"</span><span class="op">)</span>,</span>
<span>name_comparison<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>data<span class="op">=</span><span class="st">"Young"</span>, data2<span class="op">=</span> <span class="st">"Old"</span><span class="op">)</span>,</span>
<span>plot_name<span class="op">=</span> <span class="st">"Young-TUMOR_vs_NORMAL compared to Old-TUMOR_vs_NORMAL"</span>,</span>
<span>subtitle<span class="op">=</span> <span class="st">"Results of dma"</span> <span class="op">)</span></span></code></pre></div>
<p><img src="sample-metadata_files/figure-html/viz-volcano-2.png" class="r-plt" width="700"><br>
Here we can observe that Tumour versus Normal has lower significance
values for the Young patients compared to the Old patients. This can be
due to higher variance in the metabolite measurements from Young
patients compared to the Old patients.<br>
We can also check if the top changed metabolites comparing Tumour versus
Normal correlate with the main metabolite drivers that separate patients
based on their <code>TISSUE_TYPE</code>, which are Tumour or
Normal.<br></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the top changed metabolites</span></span>
<span><span class="va">top_entries</span> <span class="op">&lt;-</span> <span class="va">ResList</span><span class="op">[[</span><span class="st">"TissueType"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">t.val</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Metabolite</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bottom_entries</span> <span class="op">&lt;-</span> <span class="va">ResList</span><span class="op">[[</span><span class="st">"TissueType"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">t.val</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">24</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Metabolite</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check if those overlap with the top demographics drivers</span></span>
<span><span class="fu">ggVennDiagram</span><span class="fu">::</span><span class="fu"><a href="https://gaospecial.github.io/ggVennDiagram/reference/ggVennDiagram.html" class="external-link">ggVennDiagram</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>top <span class="op">=</span> <span class="va">top_entries</span>,</span>
<span>Bottom <span class="op">=</span> <span class="va">bottom_entries</span>,</span>
<span>TissueTypeList <span class="op">=</span> <span class="va">TissueTypeList</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-metadata_files/figure-html/viz-volcano-2-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">MetaData_Metab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tissue_meta</span>,</span>
<span>y<span class="op">=</span> <span class="va">MetaRes</span><span class="op">[[</span><span class="st">"res_summary"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"feature"</span><span class="op">)</span>,</span>
<span>by<span class="op">=</span><span class="fl">0</span>,</span>
<span>all.y<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Row.names"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make a Volcano plot:</span></span>
<span><span class="fu"><a href="../../reference/viz_volcano.html">viz_volcano</a></span><span class="op">(</span>plot_types<span class="op">=</span><span class="st">"Standard"</span>,</span>
<span>data<span class="op">=</span><span class="va">ResList</span><span class="op">[[</span><span class="st">"TissueType"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Metabolite"</span><span class="op">)</span>,</span>
<span>metadata_feature <span class="op">=</span>  <span class="va">MetaData_Metab</span>,</span>
<span>metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"MainDriver_Term"</span><span class="op">)</span>,</span>
<span>plot_name<span class="op">=</span> <span class="st">"TISSUE_TYPE-TUMOR_vs_NORMAL"</span>,</span>
<span>subtitle<span class="op">=</span> <span class="st">"Results of dma"</span> <span class="op">)</span></span></code></pre></div>
<p><img src="sample-metadata_files/figure-html/viz-volcano-2-2.png" class="r-plt" width="700"></p>
</div>
<div class="section level3">
<h3 id="metabolite-id-qc">Metabolite ID QC<a class="anchor" aria-label="anchor" href="#metabolite-id-qc"></a>
</h3>
<p>Before we perform enrichment analysis,it is important to check the
availability of metabolite IDs that we aim to use. We can first create
an overview plot:</p>
<pre><code><span><span class="co">#&gt; Warning: `aes_string()` was deprecated in ggplot2 3.0.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use tidy evaluation idioms with `aes()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> See also `vignette("ggplot2-in-packages")` for more information.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">MetaProViz</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/saezlab/MetaProViz/issues&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Warning: themes$intersections_matrix is not a valid theme.</span></span>
<span><span class="co">#&gt; Please use `theme()` to construct themes.</span></span>
<span><span class="co">#&gt; Warning: `legend.margin` must be specified using `margin()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> For the old behavior use `legend.spacing`</span></span>
<span><span class="co">#&gt; Warning: themes$intersections_matrix is not a valid theme.</span></span>
<span><span class="co">#&gt; Please use `theme()` to construct themes.</span></span>
<span><span class="co">#&gt; Warning: selected_theme is not a valid theme.</span></span>
<span><span class="co">#&gt; Please use `theme()` to construct themes.</span></span>
<span><span class="co">#&gt; Warning: `legend.margin` must be specified using `margin()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> For the old behavior use `legend.spacing`</span></span>
<span><span class="co">#&gt; Warning: selected_theme is not a valid theme.</span></span>
<span><span class="co">#&gt; Please use `theme()` to construct themes.</span></span>
<span><span class="co">#&gt; Warning: themes$overall_sizes is not a valid theme.</span></span>
<span><span class="co">#&gt; Please use `theme()` to construct themes.</span></span>
<span><span class="co">#&gt; Warning: `legend.margin` must be specified using `margin()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> For the old behavior use `legend.spacing`</span></span>
<span><span class="co">#&gt; Warning: themes$overall_sizes is not a valid theme.</span></span>
<span><span class="co">#&gt; Please use `theme()` to construct themes.</span></span>
<span><span class="co">#&gt; Note: Could not render upset plot to screen due to theme compatibility issues. Plot was saved to file successfully.</span></span></code></pre>
<p><img src="sample-metadata.Rmd_compare-pk.svg"><!-- --><br>
Here we notice that 76 features have no metabolite ID assigned, yet have
a trivial name and a metabolite class assigned. For 135 metabolites we
only have a pubchem ID, yet no HMDB or KEGG ID. Next, we will try to
understand the missing IDs focusing on HMDb as an example:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Plot1_HMDB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/count_id.html">count_id</a></span><span class="op">(</span><span class="va">MetaboliteIDs</span>, <span class="st">"HMDB"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-metadata_files/figure-html/code-6-1.png" class="r-plt" width="700"><br>
Over 200 metabolites have no HMDB ID and if there is a HMDB ID assigned,
we only have one HMDB ID. Here we assume the experimental setup does not
account for stereoisomers and that other IDs are with different degrees
of ambiguity are possible (e.g. L-Alanine HMDB ID is present and we will
add D-Alanine HMDB ID, see PK vignette for more details). This enables
us to assign additional potential HMDB IDs per feature.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Input_HMDB</span> <span class="op">&lt;-</span> <span class="va">MetaboliteIDs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">HMDB</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># ID in the measured data we want to use, hence we remove NA's</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"Metabolite"</span>, <span class="st">"HMDB"</span>, <span class="st">"SUPER_PATHWAY"</span><span class="op">)</span> <span class="co"># only keep relevant columns</span></span>
<span></span>
<span><span class="co"># Add equivalent IDs:</span></span>
<span><span class="va">tissue_meta_AddIDs_HMDB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/equivalent_id.html">equivalent_id</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">Input_HMDB</span>,</span>
<span>metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>InputID<span class="op">=</span><span class="st">"HMDB"</span><span class="op">)</span>,<span class="co"># ID in the measured data, here we use the HMDB ID</span></span>
<span>from <span class="op">=</span> <span class="st">"hmdb"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in equivalent_id(data = Input_HMDB, metadata_info = c(InputID =</span></span>
<span><span class="co">#&gt; "HMDB"), : The following IDs are duplicated and removed: HMDB01859</span></span>
<span><span class="co">#&gt; chebi is used to find additional potential IDs for hmdb.</span></span>
<span><span class="co"># Let's see how this has changed the number of entries:</span></span>
<span><span class="va">tissue_meta_AddIDs_HMDB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">MetaboliteIDs</span>,</span>
<span>y<span class="op">=</span><span class="va">tissue_meta_AddIDs_HMDB</span>,</span>
<span>by<span class="op">=</span><span class="st">"HMDB"</span>,</span>
<span>all.x<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot 2 after equivalent IDs where added</span></span>
<span><span class="va">Plot2_HMDB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/count_id.html">count_id</a></span><span class="op">(</span><span class="va">tissue_meta_AddIDs_HMDB</span>, <span class="st">"AllIDs"</span><span class="op">)</span></span></code></pre></div>
<img src="sample-metadata_files/figure-html/data-prep-1.png" class="r-plt" width="700"><br>
Additionally, for the metabolites without HMDB ID we can check if a HMDB
ID is available using the other ID types. First we check if we have
cases in which we do have no HMDB ID, but other available IDs:
<table class="table  lightable-classic" style="font-size: 12px; font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Overview of other ID types for metabolites without HMDB ID.
</caption>
<thead><tr>
<th style="text-align:right;">
Total_Cases
</th>
<th style="text-align:right;">
Not_NA_PUBCHEM
</th>
<th style="text-align:right;">
Not_NA_KEGG
</th>
<th style="text-align:right;">
Both_Not_NA
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
159
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
24
</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">no_hmdb</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">MetaboliteIDs</span>, <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">HMDB</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">PUBCHEM</span><span class="op">)</span> <span class="op">|</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">KEGG</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tissue_meta_translated_HMDB</span> <span class="op">&lt;-</span></span>
<span><span class="fu"><a href="../../reference/translate_id.html">translate_id</a></span><span class="op">(</span><span class="va">no_hmdb</span>, metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>InputID <span class="op">=</span> <span class="st">"PUBCHEM"</span>, grouping_variable <span class="op">=</span> <span class="st">"SUPER_PATHWAY"</span><span class="op">)</span>, from <span class="op">=</span> <span class="st">"pubchem"</span>, to <span class="op">=</span> <span class="st">"hmdb"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"TranslatedDF"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>hmdb_from_pubchem <span class="op">=</span> <span class="va">hmdb</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="../../reference/translate_id.html">translate_id</a></span><span class="op">(</span>metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>InputID <span class="op">=</span> <span class="st">"KEGG"</span>, grouping_variable <span class="op">=</span> <span class="st">"SUPER_PATHWAY"</span><span class="op">)</span>, from <span class="op">=</span> <span class="st">"kegg"</span>, to <span class="op">=</span> <span class="st">"hmdb"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"TranslatedDF"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>hmdb_from_kegg <span class="op">=</span> <span class="va">hmdb</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in translate_id(no_hmdb, metadata_info = list(InputID = "PUBCHEM", :</span></span>
<span><span class="co">#&gt; The following IDs are duplicated within one group: 5.24601e+13, 6.99312e+13</span></span>
<span></span>
<span><span class="co"># Here we combine the tables above, created by equivalent_id and translate_id:</span></span>
<span><span class="va">Tissue_MetaData_HMDB</span> <span class="op">&lt;-</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>    <span class="va">tissue_meta_AddIDs_HMDB</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>Metabolite <span class="op">=</span> <span class="va">Metabolite.x</span>, SUPER_PATHWAY <span class="op">=</span> <span class="va">SUPER_PATHWAY.x</span>, <span class="va">SUB_PATHWAY</span> ,<span class="va">COMP_ID</span>, <span class="va">PLATFORM</span>, <span class="va">RI</span>, <span class="va">MASS</span>, <span class="va">CAS</span>, <span class="va">PUBCHEM</span>, <span class="va">KEGG</span>,  <span class="va">HMDB</span>, hmdb_from_equivalentid <span class="op">=</span> <span class="va">AllIDs</span><span class="op">)</span>,</span>
<span>    <span class="va">tissue_meta_translated_HMDB</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">COMP_ID</span>, <span class="va">hmdb_from_pubchem</span>, <span class="va">hmdb_from_kegg</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"hmdb_from"</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">na_if</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="st">'COMP_ID'</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>hmdb_combined <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"hmdb_from"</span><span class="op">)</span><span class="op">)</span>, <span class="st">","</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>hmdb_combined <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">hmdb_combined</span>, collapse <span class="op">=</span> <span class="st">','</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="co"># we concatenate by "," only for the sake of printing in notebook</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot 3:</span></span>
<span><span class="va">Plot3_HMDB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/count_id.html">count_id</a></span><span class="op">(</span><span class="va">Tissue_MetaData_HMDB</span>, <span class="st">"hmdb_combined"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-metadata_files/figure-html/data-prep-3-1.png" class="r-plt" width="700"><br>
If we inspect the tables we can check that for example,
16-hydroxypalmitate certainly has an HMDB ID, yet was missing from the
original metadata table. We can check the structures associated to it on
<a href="https://pubchem.ncbi.nlm.nih.gov/compound/10466" class="external-link">PubChem:10466</a>
and <a href="https://www.genome.jp/entry/C18218" class="external-link">KEGG:C18218</a> are
indeed identical, and as we expect, the same structure is in HMDB too,
under the ID <a href="https://hmdb.ca/metabolites/HMDB0006294" class="external-link">HMDB0006294</a>.<br><br>
We can of course do the same for other IDs, such as the KEGG IDs:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Plot1_KEGG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/count_id.html">count_id</a></span><span class="op">(</span><span class="va">MetaboliteIDs</span>, <span class="st">"KEGG"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-metadata_files/figure-html/data-prep-4-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">##################################################################################################################</span></span>
<span><span class="va">Input_KEGG</span> <span class="op">&lt;-</span> <span class="va">Tissue_MetaData_HMDB</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">KEGG</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># ID in the measured data we want to use, hence we remove NA's</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"Metabolite"</span>, <span class="st">"KEGG"</span>, <span class="st">"SUPER_PATHWAY"</span><span class="op">)</span> <span class="co"># only keep relevant columns</span></span>
<span></span>
<span><span class="co"># Add equivalent IDs:</span></span>
<span><span class="va">tissue_meta_AddIDs_KEGG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/equivalent_id.html">equivalent_id</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">Input_KEGG</span>,</span>
<span>                                                metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>InputID<span class="op">=</span><span class="st">"KEGG"</span><span class="op">)</span>,<span class="co"># ID in the measured data, here we use the HMDB ID</span></span>
<span>                                                from <span class="op">=</span> <span class="st">"kegg"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in equivalent_id(data = Input_KEGG, metadata_info = c(InputID =</span></span>
<span><span class="co">#&gt; "KEGG"), : The following IDs are duplicated and removed: C01585, C00474,</span></span>
<span><span class="co">#&gt; C06804, C03594, C06429</span></span>
<span><span class="co">#&gt; chebi is used to find additional potential IDs for kegg.</span></span>
<span></span>
<span><span class="co"># Let's see how this has changed the number of entries:</span></span>
<span><span class="va">tissue_meta_AddIDs_KEGG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Tissue_MetaData_HMDB</span>,</span>
<span>y<span class="op">=</span><span class="va">tissue_meta_AddIDs_KEGG</span>,</span>
<span>by<span class="op">=</span><span class="st">"KEGG"</span>,</span>
<span>all.x<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Plot2_KEGG</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../../reference/count_id.html">count_id</a></span><span class="op">(</span><span class="va">tissue_meta_AddIDs_KEGG</span>, <span class="st">"AllIDs"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-metadata_files/figure-html/data-prep-4-2.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">###################################################################################################################</span></span>
<span><span class="va">no_KEGG</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Tissue_MetaData_HMDB</span>, <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">KEGG</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">PUBCHEM</span><span class="op">)</span> <span class="op">|</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">HMDB</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tissue_meta_translated_KEGG</span> <span class="op">&lt;-</span></span>
<span><span class="fu"><a href="../../reference/translate_id.html">translate_id</a></span><span class="op">(</span><span class="va">no_KEGG</span>, metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>InputID <span class="op">=</span> <span class="st">"PUBCHEM"</span>, grouping_variable <span class="op">=</span> <span class="st">"SUPER_PATHWAY"</span><span class="op">)</span>, from <span class="op">=</span> <span class="st">"pubchem"</span>, to <span class="op">=</span> <span class="st">"kegg"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"TranslatedDF"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>kegg_from_pubchem <span class="op">=</span> <span class="va">kegg</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="../../reference/translate_id.html">translate_id</a></span><span class="op">(</span>metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>InputID <span class="op">=</span> <span class="st">"HMDB"</span>, grouping_variable <span class="op">=</span> <span class="st">"SUPER_PATHWAY"</span><span class="op">)</span>, from <span class="op">=</span> <span class="st">"hmdb"</span>, to <span class="op">=</span> <span class="st">"kegg"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"TranslatedDF"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>kegg_from_hmdb <span class="op">=</span> <span class="va">kegg</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in translate_id(no_KEGG, metadata_info = list(InputID = "PUBCHEM", :</span></span>
<span><span class="co">#&gt; The following IDs are duplicated within one group: 5.24601e+13, 6.99312e+13</span></span>
<span></span>
<span><span class="co"># here we combine the tables above, created by equivalent_id and translate_id:</span></span>
<span><span class="va">Tissue_MetaData_KEGG</span> <span class="op">&lt;-</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span></span>
<span>    <span class="va">tissue_meta_AddIDs_KEGG</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>Metabolite <span class="op">=</span> <span class="va">Metabolite.x</span>, SUPER_PATHWAY <span class="op">=</span> <span class="va">SUPER_PATHWAY.x</span>,<span class="va">SUB_PATHWAY</span>, <span class="va">COMP_ID</span>, <span class="va">PLATFORM</span>, <span class="va">RI</span>, <span class="va">MASS</span>, <span class="va">CAS</span>, <span class="va">PUBCHEM</span>, HMDB<span class="op">=</span><span class="va">hmdb_combined</span> , HMDB_Original <span class="op">=</span> <span class="va">HMDB</span>, <span class="va">hmdb_from_equivalentid</span>, <span class="va">hmdb_from_kegg</span>, <span class="va">hmdb_from_pubchem</span>, , KEGG_Original <span class="op">=</span> <span class="va">KEGG</span>, kegg_from_equivalentid <span class="op">=</span> <span class="va">AllIDs</span><span class="op">)</span>,</span>
<span>    <span class="va">tissue_meta_translated_KEGG</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">COMP_ID</span>, <span class="va">kegg_from_pubchem</span>, <span class="va">kegg_from_hmdb</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"kegg_from"</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">na_if</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="st">'COMP_ID'</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>KEGG<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"kegg_from"</span><span class="op">)</span><span class="op">)</span>, <span class="st">","</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>KEGG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">KEGG</span>, collapse <span class="op">=</span> <span class="st">','</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="co"># we concatenate by "," only for the sake of printing in notebook</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Lets see the count now:</span></span>
<span><span class="va">Plot3_KEGG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/count_id.html">count_id</a></span><span class="op">(</span><span class="va">Tissue_MetaData_KEGG</span>, <span class="st">"KEGG"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample-metadata_files/figure-html/data-prep-4-3.png" class="r-plt" width="700"><br>
Lastly, we will have the new metadata table, which we can use for
enrichment analysis:</p>
<pre><code><span><span class="co">#&gt; Warning: themes$intersections_matrix is not a valid theme.</span></span>
<span><span class="co">#&gt; Please use `theme()` to construct themes.</span></span>
<span><span class="co">#&gt; Warning: `legend.margin` must be specified using `margin()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> For the old behavior use `legend.spacing`</span></span>
<span><span class="co">#&gt; Warning: themes$intersections_matrix is not a valid theme.</span></span>
<span><span class="co">#&gt; Please use `theme()` to construct themes.</span></span>
<span><span class="co">#&gt; Warning: selected_theme is not a valid theme.</span></span>
<span><span class="co">#&gt; Please use `theme()` to construct themes.</span></span>
<span><span class="co">#&gt; Warning: `legend.margin` must be specified using `margin()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> For the old behavior use `legend.spacing`</span></span>
<span><span class="co">#&gt; Warning: selected_theme is not a valid theme.</span></span>
<span><span class="co">#&gt; Please use `theme()` to construct themes.</span></span>
<span><span class="co">#&gt; Warning: themes$overall_sizes is not a valid theme.</span></span>
<span><span class="co">#&gt; Please use `theme()` to construct themes.</span></span>
<span><span class="co">#&gt; Warning: `legend.margin` must be specified using `margin()`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> For the old behavior use `legend.spacing`</span></span>
<span><span class="co">#&gt; Warning: themes$overall_sizes is not a valid theme.</span></span>
<span><span class="co">#&gt; Please use `theme()` to construct themes.</span></span>
<span><span class="co">#&gt; Note: Could not render upset plot to screen due to theme compatibility issues. Plot was saved to file successfully.</span></span></code></pre>
<p><img src="sample-metadata.Rmd_compare-pk-2.svg"><!-- --><br>
If we compare the results to the upset plot from the original metadata
we can see that initially 251 metabolites had a pubchem, HMDB and KEGG
ID, whilst after adding the equivalent IDs and translating the IDs, we
now have 285 metabolites with all three IDs. 135 metabolite had only a
Pubchem ID, whilst now we have found HMDB and/or KEGG IDs for half of
these metabolites with only 65 metabolites remaining with only a Pubchem
ID.</p>
</div>
<div class="section level3">
<h3 id="ora">ORA<a class="anchor" aria-label="anchor" href="#ora"></a>
</h3>
<p>We can perform Over Representation Analysis (<code>ORA</code>) using
KEGG pathways for each comparison and plot significant pathways.
Noteworthy, since not all metabolites have KEGG IDs, we will lose
information.<br></p>
<p><br>
Given that in some cases we have multiple KEGG IDs for a measured
feature, we will check if this causes mapping to multiple, different
entries in the KEGG pathway-metabolite sets:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Load Kegg pathways:</span></span>
<span><span class="va">KEGG_Pathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/metsigdb_kegg.html">metsigdb_kegg</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#check mapping with metadata</span></span>
<span></span>
<span><span class="va">ccRCC_to_KEGGPathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/checkmatch_pk_to_data.html">checkmatch_pk_to_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Tissue_MetaData_Extended</span>,</span>
<span>input_pk <span class="op">=</span> <span class="va">KEGG_Pathways</span>,</span>
<span>metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>InputID <span class="op">=</span> <span class="st">"KEGG"</span>, PriorID <span class="op">=</span> <span class="st">"MetaboliteID"</span>, grouping_variable <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in checkmatch_pk_to_data(data = Tissue_MetaData_Extended, input_pk =</span></span>
<span><span class="co">#&gt; KEGG_Pathways, : 251 NA values were removed from column KEGG</span></span>
<span><span class="co">#&gt; Warning in checkmatch_pk_to_data(data = Tissue_MetaData_Extended, input_pk =</span></span>
<span><span class="co">#&gt; KEGG_Pathways, : 8 duplicated IDs were removed from column KEGG</span></span>
<span><span class="co">#&gt; data has multiple IDs per measurement = TRUE. input_pk has multiple IDs per entry = FALSE.</span></span>
<span><span class="co">#&gt; data has 318 unique entries with 328 unique KEGG IDs. Of those IDs, 249 match, which is 75.9146341463415%.</span></span>
<span><span class="co">#&gt; input_pk has 6541 unique entries with 6541 unique MetaboliteID IDs. Of those IDs, 249 are detected in the data, which is 3.80675737654793%.</span></span>
<span><span class="co">#&gt; Warning in checkmatch_pk_to_data(data = Tissue_MetaData_Extended, input_pk =</span></span>
<span><span class="co">#&gt; KEGG_Pathways, : There are cases where multiple detected IDs match to multiple</span></span>
<span><span class="co">#&gt; prior knowledge IDs of the same category</span></span>
<span></span>
<span><span class="va">problems_terms</span> <span class="op">&lt;-</span> <span class="va">ccRCC_to_KEGGPathways</span><span class="op">[[</span><span class="st">"GroupingVariable_summary"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">Group_Conflict_Notes</span><span class="op">==</span> <span class="st">"None"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic" style="font-size: 12px; font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Terms in KEGG pathways where the same measured feature mapps with more
than one ID, which will inflate the enrichment analysis.
</caption>
<thead><tr>
<th style="text-align:left;">
KEGG
</th>
<th style="text-align:right;">
original_count
</th>
<th style="text-align:right;">
matches_count
</th>
<th style="text-align:left;">
MetaboliteID
</th>
<th style="text-align:left;">
term
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
C00221, C00031
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C00221
</td>
<td style="text-align:left;">
Pentose phosphate pathway
</td>
</tr>
<tr>
<td style="text-align:left;">
C00221, C00031
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C00221
</td>
<td style="text-align:left;">
Biosynthesis of secondary metabolites
</td>
</tr>
<tr>
<td style="text-align:left;">
C00221, C00031
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C00031
</td>
<td style="text-align:left;">
Glycolysis / Gluconeogenesis
</td>
</tr>
<tr>
<td style="text-align:left;">
C00221, C00031
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C00221
</td>
<td style="text-align:left;">
Glycolysis / Gluconeogenesis
</td>
</tr>
<tr>
<td style="text-align:left;">
C00221, C00031
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C00221
</td>
<td style="text-align:left;">
Metabolic pathways
</td>
</tr>
<tr>
<td style="text-align:left;">
C00221, C00031
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C00031
</td>
<td style="text-align:left;">
Biosynthesis of secondary metabolites
</td>
</tr>
<tr>
<td style="text-align:left;">
C00221, C00031
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C00031
</td>
<td style="text-align:left;">
Pentose phosphate pathway
</td>
</tr>
<tr>
<td style="text-align:left;">
C00221, C00031
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C00031
</td>
<td style="text-align:left;">
Metabolic pathways
</td>
</tr>
<tr>
<td style="text-align:left;">
C03460, C03722
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C03460
</td>
<td style="text-align:left;">
Metabolic pathways
</td>
</tr>
<tr>
<td style="text-align:left;">
C03460, C03722
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C03722
</td>
<td style="text-align:left;">
Metabolic pathways
</td>
</tr>
<tr>
<td style="text-align:left;">
C17737, C00695
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C17737
</td>
<td style="text-align:left;">
Secondary bile acid biosynthesis
</td>
</tr>
<tr>
<td style="text-align:left;">
C17737, C00695
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C00695
</td>
<td style="text-align:left;">
Secondary bile acid biosynthesis
</td>
</tr>
</tbody>
</table>
<p><br>
Dependent on the biological question and the organism and prior
knowledge, one can either maintain the metabolite ID of the more likely
metabolite (e.g. in human its moire likely that we have L-aminoacid than
D-aminoacid) or the metabolite ID that is represented in more/less
pathways (specificity). If we are looking into the cases where we do
have multiple IDs, for cases with no match to the prior knowledge we can
just maintain one ID, whilst for cases with exactly one match we should
maintain the ID that is found in the prior knowledge.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select the cases where a feature has multiple IDs</span></span>
<span><span class="va">multipleIDs</span> <span class="op">&lt;-</span> <span class="va">ccRCC_to_KEGGPathways</span><span class="op">[[</span><span class="st">"data_summary"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">original_count</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic" style="font-size: 12px; font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Terms in KEGG pathways where the same measured feature mapps with more
than one ID, which may inflate the enrichment analysis.
</caption>
<thead><tr>
<th style="text-align:left;">
KEGG
</th>
<th style="text-align:left;">
InputID_select
</th>
<th style="text-align:right;">
original_count
</th>
<th style="text-align:right;">
matches_count
</th>
<th style="text-align:left;">
matches
</th>
<th style="text-align:left;">
Group_Conflict_Notes
</th>
<th style="text-align:left;">
ActionRequired
</th>
<th style="text-align:left;">
Action_Specific
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
C00065, C00716
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C00065, C00716
</td>
<td style="text-align:left;">
None
</td>
<td style="text-align:left;">
Check
</td>
<td style="text-align:left;">
KeepEachID
</td>
</tr>
<tr>
<td style="text-align:left;">
C00155, C05330
</td>
<td style="text-align:left;">
C00155
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
C00155
</td>
<td style="text-align:left;">
None
</td>
<td style="text-align:left;">
None
</td>
<td style="text-align:left;">
None
</td>
</tr>
<tr>
<td style="text-align:left;">
C00221, C00031
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C00221, C00031
</td>
<td style="text-align:left;">
None || Pentose phosphate pathway || Biosynthesis of secondary
metabolites || Glycolysis / Gluconeogenesis || Metabolic pathways
</td>
<td style="text-align:left;">
Check
</td>
<td style="text-align:left;">
KeepOneID
</td>
</tr>
<tr>
<td style="text-align:left;">
C00671, C06008
</td>
<td style="text-align:left;">
C00671
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
C00671
</td>
<td style="text-align:left;">
None
</td>
<td style="text-align:left;">
None
</td>
<td style="text-align:left;">
None
</td>
</tr>
<tr>
<td style="text-align:left;">
C01835, C00721, C00420
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C01835, C00721
</td>
<td style="text-align:left;">
None
</td>
<td style="text-align:left;">
Check
</td>
<td style="text-align:left;">
KeepEachID
</td>
</tr>
<tr>
<td style="text-align:left;">
C01991, C00989
</td>
<td style="text-align:left;">
C00989
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
C00989
</td>
<td style="text-align:left;">
None
</td>
<td style="text-align:left;">
None
</td>
<td style="text-align:left;">
None
</td>
</tr>
<tr>
<td style="text-align:left;">
C02052, C00464
</td>
<td style="text-align:left;">
C00464
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
C00464
</td>
<td style="text-align:left;">
None
</td>
<td style="text-align:left;">
None
</td>
<td style="text-align:left;">
None
</td>
</tr>
<tr>
<td style="text-align:left;">
C03460, C03722
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C03460, C03722
</td>
<td style="text-align:left;">
None || Metabolic pathways
</td>
<td style="text-align:left;">
Check
</td>
<td style="text-align:left;">
KeepOneID
</td>
</tr>
<tr>
<td style="text-align:left;">
C17737, C00695
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C17737, C00695
</td>
<td style="text-align:left;">
Secondary bile acid biosynthesis || None
</td>
<td style="text-align:left;">
Check
</td>
<td style="text-align:left;">
KeepOneID
</td>
</tr>
</tbody>
</table>
<p><br>
In case of <code>ActionRequired=="Check"</code>, we can look into the
column <code>Action_Specific</code> which contains additional
information. In case of the entry <code>KeepEachID</code>, multiple
matches to the prior knowledge were found, yet the features are in
different pathways (=GroupingVariable). Yet, in case of
<code>KeepOneID</code>, the different IDs map to the same pathway in the
prior knowledge for at least one case and therefore keeping both would
inflate the enrichment analysis.<br></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SelectedIDs</span> <span class="op">&lt;-</span> <span class="va">ccRCC_to_KEGGPathways</span><span class="op">[[</span><span class="st">"data_summary"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="co">#Expand rows where Action == KeepEachID by splitting `matches`</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>matches_split <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">Action_Specific</span> <span class="op">==</span> <span class="st">"KeepEachID"</span>, <span class="va">matches</span>, <span class="cn">NA_character_</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate_rows.html" class="external-link">separate_rows</a></span><span class="op">(</span><span class="va">matches_split</span>, sep <span class="op">=</span> <span class="st">",\\s*"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>InputID_select <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">Action_Specific</span>  <span class="op">==</span> <span class="st">"KeepEachID"</span>, <span class="va">matches_split</span>, <span class="va">InputID_select</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">matches_split</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="co">#Select one ID for AcionSpecific==KeepOneID</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>InputID_select <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">Action_Specific</span> <span class="op">==</span> <span class="st">"KeepOneID"</span> <span class="op">&amp;</span> <span class="va">matches</span> <span class="op">==</span> <span class="st">"C03460, C03722"</span> <span class="op">~</span> <span class="st">"C03722"</span>, <span class="co"># 2-Methylprop-2-enoyl-CoA versus Quinolinate. No evidence, hence we keep the one present in more pathways ( C03722=7 pathways, C03460=2 pathway)</span></span>
<span>    <span class="va">Action_Specific</span> <span class="op">==</span> <span class="st">"KeepOneID"</span> <span class="op">&amp;</span> <span class="va">matches</span> <span class="op">==</span>  <span class="st">"C00221, C00031"</span> <span class="op">~</span> <span class="st">"C00031"</span>, <span class="co"># These are D- and L-Glucose. We have human samples, so in this conflict we will maintain L-Glucose</span></span>
<span>    <span class="va">Action_Specific</span> <span class="op">==</span> <span class="st">"KeepOneID"</span> <span class="op">&amp;</span> <span class="va">matches</span> <span class="op">==</span>  <span class="st">"C17737, C00695"</span> <span class="op">~</span> <span class="st">"C00695"</span>, <span class="co"># Allocholic acid versus Cholic acid. No evidence, hence we keep the one present in more pathways (C00695 = 4 pathways, C17737 = 1 pathway)</span></span>
<span>    <span class="va">Action_Specific</span> <span class="op">==</span> <span class="st">"KeepOneID"</span> <span class="op">~</span> <span class="va">InputID_select</span>,  <span class="co"># Keep NA where not matched manually</span></span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">InputID_select</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><br>
Lastly, we need to add the column including our selected IDs to the
metadata table:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Tissue_MetaData_Extended</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">SelectedIDs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                                        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">KEGG</span>, <span class="va">InputID_select</span><span class="op">)</span>,</span>
<span>                                        y<span class="op">=</span> <span class="va">Tissue_MetaData_Extended</span>,</span>
<span>                                        by<span class="op">=</span> <span class="st">"KEGG"</span>,</span>
<span>                                        all.y<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<br>
For results with p.adjusted value &lt; 0.1 and a minimum of 10% of the
pathway detected will be visualized as Volcano plots:<br><div class="vscroll-plot">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Since we have performed multiple comparisons (all_vs_HK2), we will run ORA for each of this comparison</span></span>
<span><span class="va">DM_ORA_res</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">comparison</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ResList</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="co">#Res list includes the different comparisons we performed above &lt;-</span></span>
<span><span class="co">#Ensure that the Metabolite names match with KEGG IDs or KEGG trivial names.</span></span>
<span><span class="va">dma_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Tissue_MetaData_Extended</span>,</span>
<span>y<span class="op">=</span> <span class="va">ResList</span><span class="op">[[</span><span class="va">comparison</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>by<span class="op">=</span><span class="st">"Metabolite"</span>,</span>
<span>all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Ensure unique IDs and full background --&gt; we include measured features that do not have a KEGG ID.</span></span>
<span><span class="va">dma_res</span> <span class="op">&lt;-</span> <span class="va">dma_res</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">21</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>InputID_select <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">InputID_select</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"NA_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">InputID_select</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="va">InputID_select</span></span>
<span>        <span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co">#remove duplications and keep the higher Log2FC measurement</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">InputID_select</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">Log2FC</span>, n <span class="op">=</span> <span class="fl">1</span>, with_ties <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">remove_rownames</a></span><span class="op">(</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"InputID_select"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co">#Perform ORA</span></span>
<span>    <span class="va">Res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/standard_ora.html">standard_ora</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">dma_res</span>, <span class="co">#Input data requirements: column `t.val` and column `Metabolite`</span></span>
<span>    metadata_info<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>pvalColumn<span class="op">=</span><span class="st">"p.adj"</span>, percentageColumn<span class="op">=</span><span class="st">"t.val"</span>, PathwayTerm<span class="op">=</span> <span class="st">"term"</span>, PathwayFeature<span class="op">=</span> <span class="st">"MetaboliteID"</span><span class="op">)</span>,</span>
<span>    input_pathway<span class="op">=</span><span class="va">KEGG_Pathways</span>,<span class="co">#Pathway file requirements: column `term`, `Metabolite` and `Description`. Above we loaded the Kegg_Pathways using Load_KEGG()</span></span>
<span>    pathway_name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"KEGG_"</span>, <span class="va">comparison</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>,</span>
<span>    min_gssize<span class="op">=</span><span class="fl">3</span>,</span>
<span>    max_gssize<span class="op">=</span><span class="fl">1000</span>,</span>
<span>    cutoff_stat<span class="op">=</span><span class="fl">0.01</span>,</span>
<span>    cutoff_percentage<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">DM_ORA_res</span><span class="op">[[</span><span class="va">comparison</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Res</span></span>
<span></span>
<span>    <span class="co">#Select to plot:</span></span>
<span>    <span class="va">Res_Select</span> <span class="op">&lt;-</span> <span class="va">Res</span><span class="op">[[</span><span class="st">"ClusterGosummary"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p.adjust</span><span class="op">&lt;</span><span class="fl">0.1</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co">#filter(pvalue&lt;0.05)%&gt;%</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">percentage_of_Pathway_detected</span><span class="op">&gt;</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">Res_Select</span><span class="op">)</span><span class="op">==</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="fu"><a href="../../reference/viz_volcano.html">viz_volcano</a></span><span class="op">(</span>plot_types<span class="op">=</span><span class="st">"PEA"</span>,</span>
<span>        data<span class="op">=</span> <span class="va">dma_res</span>, <span class="co">#Must be the data you have used as an input for the pathway analysis</span></span>
<span>        data2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Res_Select</span> <span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"term"</span><span class="op">=</span><span class="st">"ID"</span><span class="op">)</span>,</span>
<span>        metadata_info<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>PEA_Pathway<span class="op">=</span><span class="st">"term"</span>,<span class="co"># Needs to be the same in both, metadata_feature and data2.</span></span>
<span>        PEA_stat<span class="op">=</span><span class="st">"p.adjust"</span>,<span class="co">#Column data2</span></span>
<span>        PEA_score<span class="op">=</span><span class="st">"GeneRatio"</span>,<span class="co">#Column data2</span></span>
<span>        PEA_Feature<span class="op">=</span><span class="st">"MetaboliteID"</span><span class="op">)</span>,<span class="co"># Column metadata_feature (needs to be the same as row names in data)</span></span>
<span>        metadata_feature<span class="op">=</span> <span class="va">KEGG_Pathways</span>,<span class="co">#Must be the pathways used for pathway analysis</span></span>
<span>        plot_name<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"KEGG_"</span>, <span class="va">comparison</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>,</span>
<span>        subtitle<span class="op">=</span> <span class="st">"PEA"</span> <span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<p><br><br><br></p>
</div>
<div class="section level3">
<h3 id="biological-regulated-clustering">Biological regulated clustering<a class="anchor" aria-label="anchor" href="#biological-regulated-clustering"></a>
</h3>
<p>to understand which metabolites are changing independent of the
patients age, hence only due to tumour versus normal, and which
metabolites change independent of tumour versus normal, hence due to the
different age, we can use the <code><a href="../../reference/mca_2cond.html">mca_2cond()</a></code> function.<br>
Metabolite Clustering Analysis (<code>MCA</code>) enables clustering of
metabolites into groups based on logical regulatory rules. Here we set
two different thresholds, one for the differential metabolite abundance
(Log2FC) and one for the significance (e.g. p.adj). This will define if
a feature (= metabolite) is assigned into:<br>
1. “UP”, which means a metabolite is significantly up-regulated in the
underlying comparison.<br>
2. “DOWN”, which means a metabolite is significantly down-regulated in
the underlying comparison.<br>
3. “No Change”, which means a metabolite does not change significantly
in the underlying comparison and/or is not defined as
up-regulated/down-regulated based on the Log2FC threshold chosen.<br><br>
Thereby “No Change” is further subdivided into four states:<br>
1. “Not Detected”, which means a metabolite is not detected in the
underlying comparison.<br>
2. “Not Significant”, which means a metabolite is not significant in the
underlying comparison.<br>
3. “Significant positive”, which means a metabolite is significant in
the underlying comparison and the differential metabolite abundance is
positive, yet does not meet the threshold set for “UP” (e.g. Log2FC
&gt;1 = “UP” and we have a significant Log2FC=0.8).<br>
4. “Significant negative”, which means a metabolite is significant in
the underlying comparison and the differential metabolite abundance is
negative, yet does not meet the threshold set for “DOWN”.<br><br>
For more information you can also check out the other vignettes.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MCAres</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../../reference/mca_2cond.html">mca_2cond</a></span><span class="op">(</span>data_c1<span class="op">=</span><span class="va">ResList</span><span class="op">[[</span><span class="st">"Young"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>data_c2<span class="op">=</span><span class="va">ResList</span><span class="op">[[</span><span class="st">"Old"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>metadata_info_c1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>ValueCol<span class="op">=</span><span class="st">"Log2FC"</span>,StatCol<span class="op">=</span><span class="st">"p.adj"</span>, cutoff_stat<span class="op">=</span> <span class="fl">0.05</span>, ValueCutoff<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>metadata_info_c2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>ValueCol<span class="op">=</span><span class="st">"Log2FC"</span>,StatCol<span class="op">=</span><span class="st">"p.adj"</span>, cutoff_stat<span class="op">=</span> <span class="fl">0.05</span>, ValueCutoff<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>feature <span class="op">=</span> <span class="st">"Metabolite"</span>,</span>
<span>save_table <span class="op">=</span> <span class="st">"csv"</span>,</span>
<span>method_background<span class="op">=</span><span class="st">"C1&amp;C2"</span><span class="co">#Most stringend background setting, only includes metabolites detected in both comparisons</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><br>
Now we can use this information to colour code our volcano plot. We will
plot individual vocano plots for each metabolite pathway as defined by
the feature metadata provided as part of the data in <span class="citation">(Hakimi et al. 2016)</span>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add metabolite information such as KEGG ID or pathway to results</span></span>
<span><span class="va">MetaData_Metab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Tissue_MetaData</span>,</span>
<span>y<span class="op">=</span> <span class="va">MCAres</span><span class="op">[[</span><span class="st">"MCA_2Cond_Results"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">14</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Metabolite"</span><span class="op">)</span>,</span>
<span>by<span class="op">=</span><span class="fl">0</span>,</span>
<span>all.y<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Row.names"</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">SUPER_PATHWAY</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">SUB_PATHWAY</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../../reference/viz_volcano.html">viz_volcano</a></span><span class="op">(</span>plot_types<span class="op">=</span><span class="st">"Compare"</span>,</span>
<span>data<span class="op">=</span><span class="va">ResList</span><span class="op">[[</span><span class="st">"Young"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Metabolite"</span><span class="op">)</span>,</span>
<span>data2<span class="op">=</span> <span class="va">ResList</span><span class="op">[[</span><span class="st">"Old"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Metabolite"</span><span class="op">)</span>,</span>
<span>name_comparison<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>data<span class="op">=</span><span class="st">"Young"</span>, data2<span class="op">=</span> <span class="st">"Old"</span><span class="op">)</span>,</span>
<span>metadata_feature <span class="op">=</span>  <span class="va">MetaData_Metab</span>,</span>
<span>plot_name<span class="op">=</span> <span class="st">"Young-TUMOR_vs_NORMAL compared to Old-TUMOR_vs_NORMAL"</span>,</span>
<span>subtitle<span class="op">=</span> <span class="st">"Results of dma"</span>,</span>
<span>metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>individual <span class="op">=</span> <span class="st">"SUPER_PATHWAY"</span>,</span>
<span>                                        color <span class="op">=</span> <span class="st">"RG2_Significant"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../../reference/viz_volcano.html">viz_volcano</a></span><span class="op">(</span>plot_types<span class="op">=</span><span class="st">"Compare"</span>,</span>
<span>data<span class="op">=</span><span class="va">ResList</span><span class="op">[[</span><span class="st">"Young"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Metabolite"</span><span class="op">)</span>,</span>
<span>data2<span class="op">=</span> <span class="va">ResList</span><span class="op">[[</span><span class="st">"Old"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Metabolite"</span><span class="op">)</span>,</span>
<span>name_comparison<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>data<span class="op">=</span><span class="st">"Young"</span>, data2<span class="op">=</span> <span class="st">"Old"</span><span class="op">)</span>,</span>
<span>metadata_feature <span class="op">=</span>  <span class="va">MetaData_Metab</span>,</span>
<span>plot_name<span class="op">=</span> <span class="st">"Young-TUMOR_vs_NORMAL compared to Old-TUMOR_vs_NORMAL_Sub"</span>,</span>
<span>subtitle<span class="op">=</span> <span class="st">"Results of dma"</span>,</span>
<span>metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>individual <span class="op">=</span> <span class="st">"SUB_PATHWAY"</span>,</span>
<span>                                        color <span class="op">=</span> <span class="st">"RG2_Significant"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<br><div class="vscroll-plot">
<p><img src="sample-metadata_files/figure-html/viz-volcano-5-1.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-2.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-3.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-4.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-5.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-6.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-7.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-8.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"></p>
<pre><code><span><span class="co">#&gt; Skipping viz_volcano compare plot for 'NA' because no rows are available after filtering.</span></span></code></pre>
<p><img src="sample-metadata_files/figure-html/viz-volcano-5-9.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-10.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-11.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-12.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-13.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-14.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-15.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-16.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-17.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-18.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-19.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-20.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-21.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-22.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-23.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-24.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-25.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-26.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-27.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-28.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-29.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-30.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-31.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-32.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-33.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-34.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-35.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-36.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-37.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-38.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-39.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-40.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-41.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-42.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-43.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-44.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-45.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-46.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-47.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-48.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-49.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-50.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-51.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-52.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-53.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-54.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-55.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-56.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-57.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-58.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-59.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-60.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-61.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-62.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-63.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-64.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-65.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"></p>
<pre><code><span><span class="co">#&gt; Skipping viz_volcano compare plot for 'NA' because no rows are available after filtering.</span></span></code></pre>
<p><img src="sample-metadata_files/figure-html/viz-volcano-5-66.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-67.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-68.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-69.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-70.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-71.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-72.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-73.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-74.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-75.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-76.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-5-77.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"></p>
</div>
<p><br><br><br></p>
</div>
<div class="section level3">
<h3 id="pathway-enrichment">Pathway enrichment<a class="anchor" aria-label="anchor" href="#pathway-enrichment"></a>
</h3>
<p>Next, we perform Over Representation Analysis (<code>ORA</code>)
using KEGG pathways for each comparison.<br></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Since we have performed multiple comparisons (all_vs_HK2), we will run ORA for each of this comparison</span></span>
<span><span class="va">DM_ORA_res</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">KEGG_Pathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/metsigdb_kegg.html">metsigdb_kegg</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">comparison</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ResList</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">dma_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Tissue_MetaData_Extended</span>,</span>
<span>    y<span class="op">=</span><span class="va">ResList</span><span class="op">[[</span><span class="va">comparison</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"dma"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"TUMOR_vs_NORMAL"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    by<span class="op">=</span><span class="st">"Metabolite"</span>,</span>
<span>    all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co">#Ensure unique IDs and full background --&gt; we include measured features that do not have a KEGG ID.</span></span>
<span>    <span class="va">dma_res</span> <span class="op">&lt;-</span> <span class="va">dma_res</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">21</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>InputID_select <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">InputID_select</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"NA_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">InputID_select</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="va">InputID_select</span></span>
<span>        <span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co">#remove duplications and keep the higher Log2FC measurement</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">InputID_select</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">Log2FC</span>, n <span class="op">=</span> <span class="fl">1</span>, with_ties <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">remove_rownames</a></span><span class="op">(</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"InputID_select"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co">#Perform ORA</span></span>
<span>    <span class="va">Res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/standard_ora.html">standard_ora</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">dma_res</span>, <span class="co">#Input data requirements: column `t.val` and column `Metabolite`</span></span>
<span>    metadata_info<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>pvalColumn<span class="op">=</span><span class="st">"p.adj"</span>, percentageColumn<span class="op">=</span><span class="st">"t.val"</span>, PathwayTerm<span class="op">=</span> <span class="st">"term"</span>, PathwayFeature<span class="op">=</span> <span class="st">"MetaboliteID"</span><span class="op">)</span>,</span>
<span>    input_pathway<span class="op">=</span><span class="va">KEGG_Pathways</span>,<span class="co">#Pathway file requirements: column `term`, `Metabolite` and `Description`. Above we loaded the Kegg_Pathways using Load_KEGG()</span></span>
<span>    pathway_name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"KEGG_"</span>, <span class="va">comparison</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>,</span>
<span>    min_gssize<span class="op">=</span><span class="fl">3</span>,</span>
<span>    max_gssize<span class="op">=</span><span class="fl">1000</span>,</span>
<span>    cutoff_stat<span class="op">=</span><span class="fl">0.01</span>,</span>
<span>    cutoff_percentage<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">DM_ORA_res</span><span class="op">[[</span><span class="va">comparison</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Res</span></span>
<span></span>
<span>    <span class="co">#Select to plot:</span></span>
<span>    <span class="va">Res_Select</span> <span class="op">&lt;-</span> <span class="va">Res</span><span class="op">[[</span><span class="st">"ClusterGosummary"</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p.adjust</span><span class="op">&lt;</span><span class="fl">0.1</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co">#filter(pvalue&lt;0.05)%&gt;%</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">percentage_of_Pathway_detected</span><span class="op">&gt;</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">Res_Select</span><span class="op">)</span><span class="op">==</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="fu"><a href="../../reference/viz_volcano.html">viz_volcano</a></span><span class="op">(</span>plot_types<span class="op">=</span><span class="st">"PEA"</span>,</span>
<span>        data<span class="op">=</span> <span class="va">dma_res</span>, <span class="co">#Must be the data you have used as an input for the pathway analysis</span></span>
<span>        data2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Res_Select</span> <span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"term"</span><span class="op">=</span><span class="st">"ID"</span><span class="op">)</span>,</span>
<span>        metadata_info<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>PEA_Pathway<span class="op">=</span><span class="st">"term"</span>,<span class="co"># Needs to be the same in both, metadata_feature and data2.</span></span>
<span>        PEA_stat<span class="op">=</span><span class="st">"p.adjust"</span>,<span class="co">#Column data2</span></span>
<span>        PEA_score<span class="op">=</span><span class="st">"GeneRatio"</span>,<span class="co">#Column data2</span></span>
<span>        PEA_Feature<span class="op">=</span><span class="st">"MetaboliteID"</span><span class="op">)</span>,<span class="co"># Column metadata_feature (needs to be the same as row names in data)</span></span>
<span>        metadata_feature<span class="op">=</span> <span class="va">KEGG_Pathways</span>,<span class="co">#Must be the pathways used for pathway analysis</span></span>
<span>        plot_name<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"KEGG_"</span>, <span class="va">comparison</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>,</span>
<span>        subtitle<span class="op">=</span> <span class="st">"PEA"</span> <span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<br><div class="vscroll-plot">
<p><img src="sample-metadata_files/figure-html/viz-volcano-7-1.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-7-2.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-7-3.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-7-4.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-7-5.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-7-6.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"><img src="sample-metadata_files/figure-html/viz-volcano-7-7.png" class="r-plt" width="672" style="display: block; margin: auto auto auto 0;"></p>
</div>
<p><br><br><br></p>
<div class="progress progress-striped active">
<div class="progress-bar progress-bar-success" style="width: 100%">

</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<pre><code><span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Etc/UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] stringr_1.6.0      tibble_3.3.0       tidyr_1.3.1        rlang_1.1.6        dplyr_1.1.4        magrittr_2.0.4    </span></span>
<span><span class="co">#&gt; [7] MetaProViz_3.99.26 BiocStyle_2.38.0  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] RColorBrewer_1.1-3          rstudioapi_0.17.1           jsonlite_2.0.0              ggbeeswarm_0.7.2           </span></span>
<span><span class="co">#&gt;   [5] farver_2.1.2                rmarkdown_2.30              fs_1.6.6                    ragg_1.5.0                 </span></span>
<span><span class="co">#&gt;   [9] vctrs_0.6.5                 memoise_2.0.1               rstatix_0.7.3               htmltools_0.5.8.1          </span></span>
<span><span class="co">#&gt;  [13] S4Arrays_1.10.0             progress_1.2.3              curl_7.0.0                  ComplexUpset_1.3.3         </span></span>
<span><span class="co">#&gt;  [17] decoupleR_2.16.0            broom_1.0.10                cellranger_1.1.0            SparseArray_1.10.1         </span></span>
<span><span class="co">#&gt;  [21] Formula_1.2-5               sass_0.4.10                 parallelly_1.45.1           bslib_0.9.0                </span></span>
<span><span class="co">#&gt;  [25] htmlwidgets_1.6.4           desc_1.4.3                  plyr_1.8.9                  httr2_1.2.1                </span></span>
<span><span class="co">#&gt;  [29] lubridate_1.9.4             cachem_1.1.0                igraph_2.2.1                lifecycle_1.0.4            </span></span>
<span><span class="co">#&gt;  [33] pkgconfig_2.0.3             Matrix_1.7-4                R6_2.6.1                    fastmap_1.2.0              </span></span>
<span><span class="co">#&gt;  [37] MatrixGenerics_1.22.0       selectr_0.4-2               digest_0.6.38               colorspace_2.1-2           </span></span>
<span><span class="co">#&gt;  [41] patchwork_1.3.2             S4Vectors_0.48.0            textshaping_1.0.4           GenomicRanges_1.62.0       </span></span>
<span><span class="co">#&gt;  [45] RSQLite_2.4.4               ggpubr_0.6.2                labeling_0.4.3              timechange_0.3.0           </span></span>
<span><span class="co">#&gt;  [49] httr_1.4.7                  abind_1.4-8                 compiler_4.5.2              bit64_4.6.0-1              </span></span>
<span><span class="co">#&gt;  [53] withr_3.0.2                 S7_0.2.1                    backports_1.5.0             BiocParallel_1.44.0        </span></span>
<span><span class="co">#&gt;  [57] carData_3.0-5               DBI_1.2.3                   logger_0.4.1                OmnipathR_3.19.2           </span></span>
<span><span class="co">#&gt;  [61] R.utils_2.13.0              ggsignif_0.6.4              cosmosR_1.18.0              MASS_7.3-65                </span></span>
<span><span class="co">#&gt;  [65] rappdirs_0.3.3              DelayedArray_0.36.0         sessioninfo_1.2.3           scatterplot3d_0.3-44       </span></span>
<span><span class="co">#&gt;  [69] gtools_3.9.5                tools_4.5.2                 vipor_0.4.7                 beeswarm_0.4.0             </span></span>
<span><span class="co">#&gt;  [73] qcc_2.7                     zip_2.3.3                   R.oo_1.27.1                 glue_1.8.0                 </span></span>
<span><span class="co">#&gt;  [77] grid_4.5.2                  checkmate_2.3.3             reshape2_1.4.5              generics_0.1.4             </span></span>
<span><span class="co">#&gt;  [81] gtable_0.3.6                tzdb_0.5.0                  R.methodsS3_1.8.2           ggVennDiagram_1.5.4        </span></span>
<span><span class="co">#&gt;  [85] hms_1.1.4                   xml2_1.5.0                  car_3.1-3                   XVector_0.50.0             </span></span>
<span><span class="co">#&gt;  [89] BiocGenerics_0.56.0         ggrepel_0.9.6               pillar_1.11.1               vroom_1.6.6                </span></span>
<span><span class="co">#&gt;  [93] limma_3.66.0                later_1.4.4                 splines_4.5.2               lattice_0.22-7             </span></span>
<span><span class="co">#&gt;  [97] bit_4.6.0                   tidyselect_1.2.1            knitr_1.50                  gridExtra_2.3              </span></span>
<span><span class="co">#&gt; [101] bookdown_0.45               IRanges_2.44.0              Seqinfo_1.0.0               SummarizedExperiment_1.40.0</span></span>
<span><span class="co">#&gt; [105] svglite_2.2.2               stats4_4.5.2                xfun_0.54                   Biobase_2.70.0             </span></span>
<span><span class="co">#&gt; [109] statmod_1.5.1               factoextra_1.0.7            matrixStats_1.5.0           pheatmap_1.0.13            </span></span>
<span><span class="co">#&gt; [113] stringi_1.8.7               yaml_2.3.10                 kableExtra_1.4.0            evaluate_1.0.5             </span></span>
<span><span class="co">#&gt; [117] codetools_0.2-20            tcltk_4.5.2                 qvalue_2.42.0               hash_2.2.6.3               </span></span>
<span><span class="co">#&gt; [121] BiocManager_1.30.27         Polychrome_1.5.4            cli_3.6.5                   systemfonts_1.3.1          </span></span>
<span><span class="co">#&gt; [125] jquerylib_0.1.4             EnhancedVolcano_1.13.2      Rcpp_1.1.0                  readxl_1.4.5               </span></span>
<span><span class="co">#&gt; [129] XML_3.99-0.20               parallel_4.5.2              ggfortify_0.4.19            pkgdown_2.2.0              </span></span>
<span><span class="co">#&gt; [133] ggplot2_4.0.1               readr_2.1.6                 blob_1.2.4                  prettyunits_1.2.0          </span></span>
<span><span class="co">#&gt; [137] viridisLite_0.4.2           scales_1.4.0                writexl_1.5.4               inflection_1.3.7           </span></span>
<span><span class="co">#&gt; [141] purrr_1.2.0                 crayon_1.5.3                rvest_1.0.5</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Hakimi2016" class="csl-entry">
Hakimi, A Ari, Ed Reznik, Chung-Han Lee, Chad J Creighton, A Rose
Brannon, Augustin Luna, B Arman Aksoy, et al. 2016. <span>“An Integrated
Metabolic Atlas of Clear Cell Renal Cell Carcinoma.”</span> <em>Cancer
Cell</em> 29 (1): 104–16. <a href="https://doi.org/10.1016/j.ccell.2015.12.004" class="external-link">https://doi.org/10.1016/j.ccell.2015.12.004</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christina Schmidt, Denes Turei, Dimitrios Prymidis, Macabe Daley, Jannik Franken, Julio Saez-Rodriguez, Christian Frezza.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>

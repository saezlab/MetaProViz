<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Data preprocessing and normalization — processing • MetaProViz</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Data preprocessing and normalization — processing"><meta name="description" content="Applies modular normalization including 80% filtering rule, total-ion count
normalization, missing value imputation, and outlier detection using
Hotelling's T2 test."><meta property="og:description" content="Applies modular normalization including 80% filtering rule, total-ion count
normalization, missing value imputation, and outlier detection using
Hotelling's T2 test."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MetaProViz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.99.25</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book-open"></span></button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-"><li><a class="dropdown-item" href="../articles/quick-start.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes/pkgdown/standard-metabolomics.html">Standard Metabolomics</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes/pkgdown/core-metabolomics.html">CoRe Metabolomics</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes/pkgdown/prior-knowledge.html">Prior Knowledge</a></li>
    <li><a class="dropdown-item" href="../articles/vignettes/pkgdown/sample-metadata.html">Sample Metadata Analysis</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-solid fa-rocket"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/saezlab/MetaProViz"><span class="fa fa-brands fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://saezlab.org/"><span class="fa fas fa-university"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://frezza.cecad-labs.uni-koeln.de/home"><span class="fa fas fa-university"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Data preprocessing and normalization</h1>
      <small class="dont-index">Source: <a href="https://github.com/saezlab/MetaProViz/blob/main/R/Processing.R" class="external-link"><code>R/Processing.R</code></a></small>
      <div class="d-none name"><code>processing.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Applies modular normalization including 80% filtering rule, total-ion count
normalization, missing value imputation, and outlier detection using
Hotelling's T2 test.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">processing</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  metadata_sample <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Conditions <span class="op">=</span> <span class="st">"Conditions"</span><span class="op">)</span>,</span>
<span>  featurefilt <span class="op">=</span> <span class="st">"Modified"</span>,</span>
<span>  cutoff_featurefilt <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  tic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mvi <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mvi_percentage <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  hotellins_confidence <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  core <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  save_plot <span class="op">=</span> <span class="st">"svg"</span>,</span>
<span>  save_table <span class="op">=</span> <span class="st">"csv"</span>,</span>
<span>  print_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  path <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>SummarizedExperiment or data frame. If SummarizedExperiment,
metadata_sample is extracted from colData. If data frame, provide unique
sample identifiers as row names and metabolite numerical values in
columns with metabolite identifiers as column names. Use NA for
undetected metabolites.</p></dd>


<dt id="arg-metadata-sample">metadata_sample<a class="anchor" aria-label="anchor" href="#arg-metadata-sample"></a></dt>
<dd><p>Data frame (optional). Only required if data is not a
SummarizedExperiment. Contains information about samples, combined with
input data based on unique sample identifiers used as row names. Must
contain Conditions column. If experiment has no multiple conditions,
assign all samples to same condition. Default: NULL.</p></dd>


<dt id="arg-metadata-info">metadata_info<a class="anchor" aria-label="anchor" href="#arg-metadata-info"></a></dt>
<dd><p>Named character vector (optional). Contains names of experimental
parameters: c(Conditions="ColumnName",
Biological_Replicates="ColumnName"). Column "Conditions" (mandatory)
contains sample conditions (e.g., "N"/"T" or "Normal"/"Tumor"), used for
feature filtering and PCA color coding. Column "BiologicalReplicates"
(optional) contains numerical values. For core=TRUE, must also add
core_norm_factor="ColumnName" and core_media="ColumnName". Column
core_norm_factor is used for normalization; core_media specifies media
controls in Conditions. Default: c(Conditions="Conditions").</p></dd>


<dt id="arg-featurefilt">featurefilt<a class="anchor" aria-label="anchor" href="#arg-featurefilt"></a></dt>
<dd><p>Character (optional). If NULL, no feature filtering is performed. If
"Standard", applies 80% filtering rule (Bijlsma et al., 2006) on
metabolite features across whole dataset. If "Modified", filtering is
done per condition and Conditions column must be provided (Yang et al.,
2015). Default: "Standard".</p></dd>


<dt id="arg-cutoff-featurefilt">cutoff_featurefilt<a class="anchor" aria-label="anchor" href="#arg-cutoff-featurefilt"></a></dt>
<dd><p>Numeric (optional). Percentage threshold for feature filtering. Default:
0.8.</p></dd>


<dt id="arg-tic">tic<a class="anchor" aria-label="anchor" href="#arg-tic"></a></dt>
<dd><p>Logical (optional). Whether total ion count normalization is performed.
Default: TRUE.</p></dd>


<dt id="arg-mvi">mvi<a class="anchor" aria-label="anchor" href="#arg-mvi"></a></dt>
<dd><p>Logical (optional). Whether missing value imputation (MVI) based on half
minimum is performed. Default: TRUE.</p></dd>


<dt id="arg-mvi-percentage">mvi_percentage<a class="anchor" aria-label="anchor" href="#arg-mvi-percentage"></a></dt>
<dd><p>Numeric (optional). Percentage (0-100) of imputed value based on minimum
value. Default: 50.</p></dd>


<dt id="arg-hotellins-confidence">hotellins_confidence<a class="anchor" aria-label="anchor" href="#arg-hotellins-confidence"></a></dt>
<dd><p>Numeric (optional). Confidence level for outlier identification in
Hotelling's T2 test. Default: 0.99.</p></dd>


<dt id="arg-core">core<a class="anchor" aria-label="anchor" href="#arg-core"></a></dt>
<dd><p>Logical (optional). Whether consumption-release experiment was performed
and core value should be calculated. If TRUE, provide normalization
factor column "core_norm_factor" in metadata_sample where Conditions
column matches. The normalization factor must be numerical value from
growth rate (growth curve) or growth factor (ratio of cell count/protein
quantification at start vs. end point). Additionally, control media
samples must be available in data and defined as "core_media" in
Conditions column of metadata_sample. Default: FALSE.</p></dd>


<dt id="arg-save-plot">save_plot<a class="anchor" aria-label="anchor" href="#arg-save-plot"></a></dt>
<dd><p>Character (optional). File type of output plots: "svg", "png", "pdf". If
NULL, plots are not saved. Default: "svg".</p></dd>


<dt id="arg-save-table">save_table<a class="anchor" aria-label="anchor" href="#arg-save-table"></a></dt>
<dd><p>Character (optional). File type of output table: "csv", "xlsx", "txt".
If NULL, tables are not saved. Default: "csv".</p></dd>


<dt id="arg-print-plot">print_plot<a class="anchor" aria-label="anchor" href="#arg-print-plot"></a></dt>
<dd><p>Logical (optional). Whether to print overview of resulting plots.
Default: TRUE.</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>Character (optional). Path to folder where results should be saved.
Default: NULL.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with two elements: DF (all output tables generated) and Plot (all
plots generated).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">intracell_raw_se</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ResI</span> <span class="op">&lt;-</span> <span class="fu">processing</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">intracell_raw_se</span>,</span></span>
<span class="r-in"><span>    metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        Conditions <span class="op">=</span> <span class="st">"Conditions"</span>,</span></span>
<span class="r-in"><span>        Biological_Replicates <span class="op">=</span> <span class="st">"Biological_Replicates"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> feature_filtering: Here we apply the modified 80%-filtering rule that takes the class information (Column `Conditions`) into account, which additionally reduces the effect of missing values (REF: Yang et. al., (2015), doi: 10.3389/fmolb.2015.00004). Filtering value selected: 0.8</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 3 metabolites where removed: AICAR, FAICAR, SAICAR</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Missing Value Imputation: Missing value imputation is performed, as a complementary approach to address the missing value problem, where the missing values are imputing using the `half minimum value`. REF: Wei et. al., (2018), Reports, 8, 663, doi:https://doi.org/10.1038/s41598-017-19120-0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> total Ion Count (tic) normalization: total Ion Count (tic) normalization is used to reduce the variation from non-biological sources, while maintaining the biological variation. REF: Wulff et. al., (2018), Advances in Bioscience and Biotechnology, 9, 339-351, doi:https://doi.org/10.4236/abb.2018.98022</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Outlier detection: Identification of outlier samples is performed using Hotellin's T2 test to define sample outliers in a mathematical way (Confidence = 0.99 ~ p.val &lt; 0.01) (REF: Hotelling, H. (1931), Annals of Mathematical Statistics. 2 (3), 360-378, doi:https://doi.org/10.1214/aoms/1177732979). hotellins_confidence value selected: 0.99</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> There are possible outlier samples in the data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering round  1  Outlier Samples:  MS55_29  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering round  2  Outlier Samples:  MS55_30  </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 1 row containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_point()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 1 row containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_point()`).</span>
<span class="r-plt img"><img src="processing-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="processing-2.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 35 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-3.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 36 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-4.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-5.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 24 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-6.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 27 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-7.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-8.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 13 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-9.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 15 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-10.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-11.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 35 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-12.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 36 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 35 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-13.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 36 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">intracell_raw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Intra</span> <span class="op">&lt;-</span> <span class="va">intracell_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Code"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ResI</span> <span class="op">&lt;-</span> <span class="fu">processing</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">Intra</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">49</span><span class="op">:</span><span class="fl">58</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    metadata_sample <span class="op">=</span> <span class="va">Intra</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">49</span><span class="op">:</span><span class="fl">58</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        Conditions <span class="op">=</span> <span class="st">"Conditions"</span>,</span></span>
<span class="r-in"><span>        Biological_Replicates <span class="op">=</span> <span class="st">"Biological_Replicates"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> feature_filtering: Here we apply the modified 80%-filtering rule that takes the class information (Column `Conditions`) into account, which additionally reduces the effect of missing values (REF: Yang et. al., (2015), doi: 10.3389/fmolb.2015.00004). Filtering value selected: 0.8</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 3 metabolites where removed: AICAR, FAICAR, SAICAR</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Missing Value Imputation: Missing value imputation is performed, as a complementary approach to address the missing value problem, where the missing values are imputing using the `half minimum value`. REF: Wei et. al., (2018), Reports, 8, 663, doi:https://doi.org/10.1038/s41598-017-19120-0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> total Ion Count (tic) normalization: total Ion Count (tic) normalization is used to reduce the variation from non-biological sources, while maintaining the biological variation. REF: Wulff et. al., (2018), Advances in Bioscience and Biotechnology, 9, 339-351, doi:https://doi.org/10.4236/abb.2018.98022</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Outlier detection: Identification of outlier samples is performed using Hotellin's T2 test to define sample outliers in a mathematical way (Confidence = 0.99 ~ p.val &lt; 0.01) (REF: Hotelling, H. (1931), Annals of Mathematical Statistics. 2 (3), 360-378, doi:https://doi.org/10.1214/aoms/1177732979). hotellins_confidence value selected: 0.99</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> There are possible outlier samples in the data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering round  1  Outlier Samples:  MS55_29  </span>
<span class="r-plt img"><img src="processing-15.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="processing-16.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 26 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-17.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 26 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-18.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-19.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 16 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-20.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 16 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-21.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-22.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 26 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-23.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 26 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 26 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-24.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 26 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-25.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">medium_raw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Media</span> <span class="op">&lt;-</span> <span class="va">medium_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Code"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ResM</span> <span class="op">&lt;-</span> <span class="fu">processing</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">Media</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span><span class="op">:</span><span class="fl">45</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    metadata_sample <span class="op">=</span> <span class="va">Media</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span><span class="op">:</span><span class="fl">45</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    metadata_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        Conditions <span class="op">=</span> <span class="st">"Conditions"</span>,</span></span>
<span class="r-in"><span>        Biological_Replicates <span class="op">=</span> <span class="st">"Biological_Replicates"</span>,</span></span>
<span class="r-in"><span>        core_norm_factor <span class="op">=</span> <span class="st">"GrowthFactor"</span>,</span></span>
<span class="r-in"><span>        core_media <span class="op">=</span> <span class="st">"blank"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    core <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> For Consumption Release experiment we are using the method from Jain M.  REF: Jain et. al, (2012), Science 336(6084):1040-4, doi: 10.1126/science.1218595.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> feature_filtering: Here we apply the modified 80%-filtering rule that takes the class information (Column `Conditions`) into account, which additionally reduces the effect of missing values (REF: Yang et. al., (2015), doi: 10.3389/fmolb.2015.00004). Filtering value selected: 0.8</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 3 metabolites where removed: N-acetylaspartylglutamate, hypotaurine, S-(2-succinyl)cysteine</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Missing Value Imputation: Missing value imputation is performed, as a complementary approach to address the missing value problem, where the missing values are imputing using the `half minimum value`. REF: Wei et. al., (2018), Reports, 8, 663, doi:https://doi.org/10.1038/s41598-017-19120-0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> NA values were found in Control_media samples for metabolites. For metabolites including NAs mvi is performed unless all samples of a metabolite are NA.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Metabolites with high NA load (&gt;20%) in Control_media samples are: dihydroorotate.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Metabolites with only NAs (= 100%) in Control_media samples are: hydroxyphenylpyruvate. Those NAs are set zero as we consider them true zeros</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> total Ion Count (tic) normalization: total Ion Count (tic) normalization is used to reduce the variation from non-biological sources, while maintaining the biological variation. REF: Wulff et. al., (2018), Advances in Bioscience and Biotechnology, 9, 339-351, doi:https://doi.org/10.4236/abb.2018.98022</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 5 rows containing non-finite outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`stat_boxplot()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 5 rows containing non-finite outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`stat_boxplot()`).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 8 of variables have high variability (CV &gt; 30) in the core_media control samples. Consider checking the pooled samples to decide whether to remove these metabolites or not.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `stat_bin()` using `bins = 30`. Pick better value `binwidth`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The following aesthetics were dropped during statistical transformation: <span style="color: #00BB00;">label</span>.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> This can happen when ggplot fails to infer the correct grouping structure in</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   the data.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Did you forget to specify a `group` aesthetic or to convert a numerical</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   variable into a factor?</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Bin width defaults to 1/30 of the range of the data. Pick better value with</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `binwidth`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The following aesthetics were dropped during statistical transformation: <span style="color: #00BB00;">label</span>.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> This can happen when ggplot fails to infer the correct grouping structure in</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   the data.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Did you forget to specify a `group` aesthetic or to convert a numerical</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   variable into a factor?</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The core_media samples  MS51-06  were found to be different from the rest. They will not be included in the sum of the core_media samples.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> core data are normalised by substracting mean (blank) from each sample and multiplying with the core_norm_factor</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Outlier detection: Identification of outlier samples is performed using Hotellin's T2 test to define sample outliers in a mathematical way (Confidence = 0.99 ~ p.val &lt; 0.01) (REF: Hotelling, H. (1931), Annals of Mathematical Statistics. 2 (3), 360-378, doi:https://doi.org/10.1214/aoms/1177732979). hotellins_confidence value selected: 0.99</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> There are possible outlier samples in the data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering round  1  Outlier Samples:  MS51-06  </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtering round  2  Outlier Samples:  MS51-09  </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 5 rows containing non-finite outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`stat_boxplot()`).</span>
<span class="r-plt img"><img src="processing-26.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 5 rows containing non-finite outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`stat_boxplot()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 5 rows containing non-finite outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`stat_boxplot()`).</span>
<span class="r-plt img"><img src="processing-27.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 5 rows containing non-finite outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`stat_boxplot()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 9 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-28.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 9 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-29.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-30.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 3 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-31.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 4 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-32.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-33.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 3 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-34.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 3 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-35.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-plt img"><img src="processing-36.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 8 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-37.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 10 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 8 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-38.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>ggrepel: 10 unlabeled data points (too many overlaps). Consider increasing max.overlaps</span>
<span class="r-plt img"><img src="processing-39.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="processing-40.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="processing-41.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christina Schmidt, Denes Turei, Dimitrios Prymidis, Macabe Daley, Jannik Franken, Julio Saez-Rodriguez, Christian Frezza.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

